<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>Developer manual</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
<script type="text/javascript" src=".//javascripts/menu.js"></script>
<script type="text/javascript" src=".//javascripts/sidebar.js"></script>
<script type="text/javascript" src=".//javascripts/steps.js"></script>
<script type="text/javascript" src=".//javascripts/sourcecode/source-utils.js"></script>
<script type="text/javascript" src=".//javascripts/sourcecode/highlight-lines.js"></script>
<script type="text/javascript" src=".//javascripts/sourcecode/collapse-lines.js"></script>
<script type="text/javascript" src=".//javascripts/tabcontainer.js"></script>
<script type="text/javascript" src="//unpkg.com/clipboard@2.0.0/dist/clipboard.min.js"></script>
<script type="text/javascript" src=".//javascripts/clipboard.js"></script>
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.js"></script>
<script type="text/javascript" src=".//javascripts/search.js"></script>
<!-- <link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.2/united/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css"
  /> -->
<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,800" rel="stylesheet">
<link rel="stylesheet" type="text/css" href=".//styles/zetapush-styles.css" />
<link rel="stylesheet" type="text/css" href=".//styles/custom-styles.css" />
<link rel="stylesheet" type="text/css" href=".//styles/tabcontainer.css" />
<link rel="stylesheet" type="text/css" href=".//styles/steps.css" />
<link rel="stylesheet" type="text/css" href=".//styles/sourcecode/collapse-lines.css" />
<link rel="stylesheet" type="text/css" href=".//styles/sourcecode/highlight-lines.css" />
<link rel="stylesheet" type="text/css" href=".//styles/clipboard.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.css">
<script type="text/html" id="hit-template">
  <div class="hit">
    <div class="hit-content">
      <div class="context">
        <a href="{{sourceFile.url}}">{{sourceFile.title}}</a>
        {{#parents}}
          <a href="{{url}}">{{title}}</a>
        {{/parents}}
        <a href="{{url}}">{{{_highlightResult.title.value}}}</a>
      </div>
      <pre class="hit-description">{{{_highlightResult.content.value}}}</pre>
    </div>
  </div>
</script>
<header>
  <nav>
    <div class="main-title"><span></span><i class="fa fa-caret-down"></i></div>
    <ul>
      <li><a href="/documentation"><span>ZetaPush documentation</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/quick-start.html"><span>Quick start</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/developer-manual.html"><span>Developer manual</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/how-to.html"><span>How to guides</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/tutorials.html"><span>Tutorials</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/reference.html"><span>Reference</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="http://docv2.zetapush.com"><span>Documentation v2</span><i class="fa fa-angle-right"></i></a></li>
    </ul>
    <div>
      <div class="contact-us">
        <a href="https://spectrum.chat/zetapush" target="_blank">Contact us</a>
      </div>
      <div class="github">
        <a href="https://github.com/zetapush" target="_blank">
          <span>Join us on</span><i class="fa fa-github-alt" title="Github"></i></a>
      </div>
      <div class="search">
        <input id="search-input" placeholder="Search for products">
        <div class="search-results">
          <div id="search-hits"></div>
        </div>
      </div>
      <div class="logo">
        <a href="https://zetapush.com"><span class="icon"></span></a>
      </div>
    </div>
  </nav>
</header>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Developer manual</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_requirements">Requirements</a>
<ul class="sectlevel2">
<li><a href="#_system_requirements">System requirements</a></li>
<li><a href="#_using_cli">Using CLI</a></li>
</ul>
</li>
<li><a href="#_zetapush_account_management">ZetaPush account management</a>
<ul class="sectlevel2">
<li><a href="#_create_a_new_account_and_a_new_application">Create a new account and a new application</a></li>
<li><a href="#_add_a_new_application_to_your_account">Add a new application to your account</a></li>
<li><a href="#_configure_your_project_to_use_an_existing_application">Configure your project to use an existing application</a></li>
</ul>
</li>
<li><a href="#_develop_your_front_with_zetapush">Develop your front with ZetaPush</a>
<ul class="sectlevel2">
<li><a href="#_requirements_2">Requirements</a></li>
<li><a href="#_use_em_cloud_services_em">Use <em>cloud services</em></a></li>
<li><a href="#_configure_adapt_zetapush_cloud_services">Configure/adapt ZetaPush cloud services</a></li>
<li><a href="#_run_your_front_locally">Run your front locally</a></li>
</ul>
</li>
<li><a href="#_develop_your_business_logic">Develop your business logic</a>
<ul class="sectlevel2">
<li><a href="#_what_is_a_em_custom_cloud_service_em">What is a <em>custom cloud service</em></a></li>
<li><a href="#_define_a_em_custom_cloud_service_em">Define a <em>custom cloud service</em></a></li>
<li><a href="#_run_a_em_custom_cloud_service_em">Run a <em>custom cloud service</em></a></li>
<li><a href="#_use_a_em_custom_cloud_service_em_in_your_front">Use a <em>custom cloud service</em> in your front</a></li>
<li><a href="#_hot_reload">Hot reload</a></li>
</ul>
</li>
<li><a href="#_deploy_publish_your_application">Deploy/publish your application</a>
<ul class="sectlevel2">
<li><a href="#_what_will_be_deployed">What will be deployed ?</a></li>
<li><a href="#_deploy_both_front_and_em_custom_cloud_services_em_on_the_zetapush_cloud">Deploy both front and <em>custom cloud services</em> on the ZetaPush Cloud</a></li>
<li><a href="#_deploy_your_front_on_the_zetapush_cloud">Deploy your front on the ZetaPush Cloud</a></li>
<li><a href="#_deploy_your_em_custom_cloud_services_em_on_the_zetapush_cloud">Deploy your <em>custom cloud services</em> on the ZetaPush Cloud</a></li>
</ul>
</li>
<li><a href="#_debug">Debug</a>
<ul class="sectlevel2">
<li><a href="#_debug_your_application_with_vscode">Debug your application with VSCode</a></li>
<li><a href="#_debug_your_application_with_intellij_based_ide">Debug your application with IntelliJ based IDE</a></li>
</ul>
</li>
<li><a href="#_testing">Testing</a>
<ul class="sectlevel2">
<li><a href="#_unit_testing_your_front">Unit testing your front</a></li>
<li><a href="#_unit_testing_your_custom_cloud_services">Unit testing your custom cloud services</a></li>
<li><a href="#_integration_testing_your_front">Integration testing your front</a></li>
<li><a href="#_integration_testing_your_custom_cloud_services">Integration testing your custom cloud services</a></li>
<li><a href="#_functional_testing_end_to_end_testing">Functional testing / end-to-end testing</a></li>
</ul>
</li>
<li><a href="#_configuration_of_cloud_services">Configuration of cloud services</a>
<ul class="sectlevel2">
<li><a href="#configuration-of-standard-user-workflow">Standard User Workflow</a></li>
</ul>
</li>
<li><a href="#_extension_of_cloud_services">Extension of cloud services</a>
<ul class="sectlevel2">
<li><a href="#extension-of-standard-user-workflow">Standard User Workflow</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_requirements"><a class="anchor" href="#_requirements"></a>Requirements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_system_requirements"><a class="anchor" href="#_system_requirements"></a>System requirements</h3>
<div class="paragraph">
<p>To create an application with ZetaPush you only need the Node.js ecosystem:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>Node.js version 8.11.2 (LTS) or higher</p>
</li>
<li>
<p>npm version 5.x or higher</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Node.js is used to:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>create custom cloud services</p>
</li>
<li>
<p>locally run custom cloud services</p>
</li>
<li>
<p>deploy your application on ZetaPush</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Install Node.js and npm</strong></p>
</div>
<div class="paragraph">
<p>Go to <a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">Node.js Downloads</a> and follow the installation instructions.</p>
</div>
<div class="paragraph">
<p>You also need to install additional tools for Node.js:</p>
</div>
<div class="paragraph tab-container">
<p>Additional tools</p>
</div>
<div class="paragraph tab">
<p>Windows</p>
</div>
<div class="paragraph">
<p>You must install development tools on Windows (Visual Studio Build Tools and Python).
Fortunately, there is a npm tool that helps you to install all required dependencies.
You must run this command line using <strong>PowerShell</strong> as <strong>Administrator</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">npm install --global --production windows-build-tools</code></pre>
</div>
</div>
<div class="paragraph">
<p>Be patient! It may take a while.</p>
</div>
<div class="paragraph tab">
<p>Debian/Ubuntu</p>
</div>
<div class="paragraph">
<p>Install build tools:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">sudo apt-get install -y build-essential</code></pre>
</div>
</div>
<div class="paragraph tab">
<p>Enterprise Linux and Fedora</p>
</div>
<div class="paragraph">
<p>Install build tools:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">sudo yum install gcc-c++ make
# or: sudo yum groupinstall 'Development Tools'</code></pre>
</div>
</div>
<div class="paragraph tab-container-end">
<p>-</p>
</div>
</div>
<div class="sect2">
<h3 id="_using_cli"><a class="anchor" href="#_using_cli"></a>Using CLI</h3>
<div class="paragraph">
<p>Once your have your application ready (see <a href="./quick-start.html">Quick start</a> if you don&#8217;t have created an application) you can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Run the backend code (Worker) locally</p>
</li>
<li>
<p>Deploy your application</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To do this we provide a <em>CLI</em> (Command Line Interface) to help you focus on your code and not spend time on writing commands or scripts.</p>
</div>
<div class="paragraph">
<p>The <em>CLI</em> module is declared in the <code>package.json</code> of the project so it is installed by npm when you create your project
(see <a href="./quick-start.html#_create_your_first_application">how to create an application using npm</a> if you haven&#8217;t created a project).</p>
</div>
<div class="paragraph">
<p>When the project is created, we configure the <code>package.json</code> with a <code>scripts</code> section to make aliases that work
directly with npm.</p>
</div>
<div class="sect3">
<h4 id="_use_npm_script_aliases_to_run_the_em_cli_em"><a class="anchor" href="#_use_npm_script_aliases_to_run_the_em_cli_em"></a>Use npm script aliases to run the <em>CLI</em></h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm run &lt;alias&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to run your worker locally using script alias, you can execute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm run start</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>start</code> alias calls <code>zeta run</code> under the hood.</p>
</div>
<div class="paragraph">
<p>The <code>start</code> alias is used because it is the standard alias to use in development.
We follow npm conventions so a user that is used to npm know which command to
execute to start is project locally.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you want to deploy your application using script alias, you can execute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm run deploy</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>start</code> alias calls <code>zeta push</code> under the hood.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_use_em_cli_em_directly"><a class="anchor" href="#_use_em_cli_em_directly"></a>Use <em>CLI</em> directly</h4>
<div class="paragraph">
<p>With the CLI, you can run your worker with:</p>
</div>
<div class="listingblock">
<div class="title">Run worker</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>$ zeta run</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Or deploy your application with:</p>
</div>
<div class="listingblock">
<div class="title">Deploy the application</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>$ zeta push</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>There are 3 ways to use directly <code>zeta</code> commands provided by the <em>CLI</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set an environment variable that points to your local <code>node_modules/.bin</code> (recommended)</p>
</li>
<li>
<p>Use <code>npx</code> tool</p>
</li>
<li>
<p>Install <em>CLI</em> as global (not recommended)</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_update_your_path_environment_variable_recommended"><a class="anchor" href="#_update_your_path_environment_variable_recommended"></a>Update your PATH environment variable (recommended)</h5>
<div class="paragraph">
<p>In order to be able to run <code>zeta</code> commands directly, you need to update your PATH.</p>
</div>
<div class="paragraph tab-container">
<p>Update environement variables</p>
</div>
<div class="paragraph tab">
<p>Debian/Ubuntu/MacOSX</p>
</div>
<div class="paragraph">
<p>You need to add it to your shell config file ~/.zshrc ~/.profile or ~/.bashrc.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ export PATH=./node_modules/.bin:$PATH</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that this will not automatically update your path for the remainder of the session. To do this, you should run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ source ~/.zshrc
$ source ~/.profile
$ source ~/.bashrc</code></pre>
</div>
</div>
<div class="paragraph tab">
<p>Windows 10 and Windows 8</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In Search, search for and then select: System (Control Panel)</p>
</li>
<li>
<p>Click the Advanced system settings link.</p>
</li>
<li>
<p>Click Environment Variables. In the section System Variables, find the PATH environment variable and select it. Click Edit. If the PATH environment variable does not exist, click New.</p>
</li>
<li>
<p>In the Edit System Variable (or New System Variable) window, specify the value of the PATH environment variable. Click OK. Close all remaining windows by clicking OK.</p>
</li>
<li>
<p>Reopen Command prompt window, and run zeta command.</p>
</li>
</ul>
</div>
<div class="paragraph tab">
<p>Windows 7</p>
</div>
<div class="ulist">
<ul>
<li>
<p>From the desktop, right click the Computer icon.</p>
</li>
<li>
<p>Choose Properties from the context menu.</p>
</li>
<li>
<p>Click the Advanced system settings link.</p>
</li>
<li>
<p>Click Environment Variables. In the section System Variables, find the PATH environment variable and select it. Click Edit. If the PATH environment variable does not exist, click New.</p>
</li>
<li>
<p>In the Edit System Variable (or New System Variable) window, specify the value of the PATH environment variable. Click OK. Close all remaining windows by clicking OK.</p>
</li>
<li>
<p>Reopen Command prompt window, and run zeta command.</p>
</li>
</ul>
</div>
<div class="paragraph tab">
<p>Windows Vista</p>
</div>
<div class="ulist">
<ul>
<li>
<p>From the desktop, right click the My Computer icon.</p>
</li>
<li>
<p>Choose Properties from the context menu.</p>
</li>
<li>
<p>Click the Advanced tab (Advanced system settings link in Vista).</p>
</li>
<li>
<p>Click Environment Variables. In the section System Variables, find the PATH environment variable and select it. Click Edit. If the PATH environment variable does not exist, click New.</p>
</li>
<li>
<p>In the Edit System Variable (or New System Variable) window, specify the value of the PATH environment variable. Click OK. Close all remaining windows by clicking OK.</p>
</li>
<li>
<p>Reopen Command prompt window, and run zeta command.</p>
</li>
</ul>
</div>
<div class="paragraph tab">
<p>Windows XP</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select Start, select Control Panel. double click System, and select the Advanced tab.</p>
</li>
<li>
<p>Click Environment Variables. In the section System Variables, find the PATH environment variable and select it. Click Edit. If the PATH environment variable does not exist, click New.</p>
</li>
<li>
<p>In the Edit System Variable (or New System Variable) window, specify the value of the PATH environment variable. Click OK. Close all remaining windows by clicking OK.</p>
</li>
<li>
<p>Reopen Command prompt window, and run zeta command.</p>
</li>
</ul>
</div>
<div class="paragraph tab-container-end">
<p>-</p>
</div>
</div>
<div class="sect4">
<h5 id="_use_npx_tool"><a class="anchor" href="#_use_npx_tool"></a>Use npx tool</h5>
<div class="paragraph">
<p>npx is shipped with npm standard install</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npx zeta &lt;command&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_install_zetapush_cli_as_a_global_command_not_recommended"><a class="anchor" href="#_install_zetapush_cli_as_a_global_command_not_recommended"></a>Install @zetapush/cli as a global command (not recommended)</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm i -g @zetapush/cli</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_zetapush_account_management"><a class="anchor" href="#_zetapush_account_management"></a>ZetaPush account management</h2>
<div class="sectionbody">
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>This section will describe the concepts behind a ZetaPush account and the links between them:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What is an account</p>
</li>
<li>
<p>What is an organization</p>
</li>
<li>
<p>What is a product</p>
</li>
<li>
<p>What is an environment</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can make a PR if you want to contribute: <a href="https://github.com/zetapush/documentation/issues/48" class="bare">https://github.com/zetapush/documentation/issues/48</a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_create_a_new_account_and_a_new_application"><a class="anchor" href="#_create_a_new_account_and_a_new_application"></a>Create a new account and a new application</h3>
<div class="paragraph">
<p>When you use ZetaPush the first time, you need to create an account. Once your account is ready, you
can already start to work. You work is associated with an application.</p>
</div>
<div class="paragraph">
<p>Here we explain how to create both an account and an application quickly.</p>
</div>
<div class="sect3">
<h4 id="_using_zetapush_main_site"><a class="anchor" href="#_using_zetapush_main_site"></a>Using ZetaPush main site</h4>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>This section will describe how to register your account through main site (mainly using screenshots).</p>
</div>
<div class="paragraph">
<p>You can make a PR if you want to contribute: <a href="https://github.com/zetapush/documentation/issues/47" class="bare">https://github.com/zetapush/documentation/issues/47</a></p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_zetapush_web_console"><a class="anchor" href="#_using_zetapush_web_console"></a>Using ZetaPush web Console</h4>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>This section will describe how to register your account through web console (mainly using screenshots).</p>
</div>
<div class="paragraph">
<p>You can make a PR if you want to contribute: <a href="https://github.com/zetapush/documentation/issues/49" class="bare">https://github.com/zetapush/documentation/issues/49</a></p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_your_terminal"><a class="anchor" href="#_using_your_terminal"></a>Using your terminal</h4>
<div class="paragraph">
<p>To create an account and an application, you can use the <em>CLI</em> we provide.
This tool will detect that you are using a new account and will automatically create a new application.</p>
</div>
<div class="imageblock center">
<div class="content">
<img src="init-without-account.png" alt="init without account" width="378" height="459">
</div>
</div>
<div class="paragraph">
<p>➊ You launch <code>npm init @zetapush myApp</code> without parameters<br>
➋ You type your email and a password to create your ZetaPush account<br>
➌ The application is created in the <code>myApp</code> folder<br>
➍ The <em>.zetarc</em> file looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre>{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerLogin</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">user@gmail.com</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerPassword</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">appName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">nameOfAppAutoGenerated</span><span class="delimiter">&quot;</span></span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
You need to confirm your ZetaPush account by clicking in the link in the email to run or deploy your application.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_add_a_new_application_to_your_account"><a class="anchor" href="#_add_a_new_application_to_your_account"></a>Add a new application to your account</h3>
<div class="sect3">
<h4 id="_using_zetapush_web_console_2"><a class="anchor" href="#_using_zetapush_web_console_2"></a>Using ZetaPush web Console</h4>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>This section will describe how to add a new application through web console (mainly using screenshots).</p>
</div>
<div class="paragraph">
<p>You can make a PR if you want to contribute: <a href="https://github.com/zetapush/documentation/issues/50" class="bare">https://github.com/zetapush/documentation/issues/50</a></p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_your_terminal_2"><a class="anchor" href="#_using_your_terminal_2"></a>Using your terminal</h4>
<div class="paragraph">
<p>To add an application to your account, you can also use the <em>CLI</em>.
This time you provide your credentials so it will use your account but as you are creating a new
application from the <em>CLI</em>, this application will be registered on ZetaPush.</p>
</div>
<div class="imageblock center">
<div class="content">
<img src="init-with-account-without-app.png" alt="init with account without app" width="434" height="351">
</div>
</div>
<div class="paragraph">
<p>➊ I launch <code>npm init @zetapush myApp</code> with the <code>--developer-login</code> and <code>--developer-password</code> parameters<br>
➋ The application is created in the <code>myApp</code> folder<br>
➌ The <em>.zetarc</em> file looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre>{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerLogin</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">user@gmail.com</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerPassword</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">appName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If the <em>appName</em> property in the <em>.zetarc</em> is empty or missing, ZetaPush deploys or executes the code in a new application.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configure_your_project_to_use_an_existing_application"><a class="anchor" href="#_configure_your_project_to_use_an_existing_application"></a>Configure your project to use an existing application</h3>
<div class="sect3">
<h4 id="_using_your_terminal_3"><a class="anchor" href="#_using_your_terminal_3"></a>Using your terminal</h4>
<div class="paragraph">
<p>When you work in team, you may want to share an application. The <em>CLI</em> also
provides a parameter to specify the application to reuse. By providing both
credentials and application name, it will just reuse existing application.</p>
</div>
<div class="imageblock center">
<div class="content">
<img src="init-with-account-and-app.png" alt="init with account and app" width="495" height="351">
</div>
</div>
<div class="paragraph">
<p>➊ I launch <code>npm init @zetapush myApp</code> with the <code>--developer-login</code>, <code>--developer-password</code> and <code>--appName</code> parameters<br>
➋ The application is created in the <code>myApp</code> folder<br>
➌ The <em>.zetarc</em> file looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre>{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerLogin</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">user@gmail.com</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerPassword</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">appName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">nameOfAppAutoGenerated</span><span class="delimiter">&quot;</span></span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configure_your_project_manually"><a class="anchor" href="#_configure_your_project_manually"></a>Configure your project manually</h4>
<div class="paragraph">
<p>If you don&#8217;t want to use the <em>CLI</em>, you can also start your project manually by creating some files.</p>
</div>
<div class="paragraph">
<p>Here the basic source tree you need to create:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">├── .zetarc
├── .gitignore
├── front
│   ├── index.html
│   └── index.js
├── worker
│   └── index.ts
└── package.json</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will see what you need to do for each file in the following sections.</p>
</div>
<div class="sect4">
<h5 id="_package_json"><a class="anchor" href="#_package_json"></a>package.json</h5>
<div class="paragraph">
<p>The <code>package.json</code> is the most important file in the application. It contains all the information needed to deploy or run your application on the ZetaPush platform.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The credentials of the ZetaPush account are in the <code>.zetarc</code> and not in <code>package.json</code> to avoid leaking sensitive information.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The minimal <code>package.json</code> is below:</p>
</div>
<div class="listingblock">
<div class="title">package.json</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
</pre></td>
  <td class="code"><pre>{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">myApp</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">main</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">worker/index.ts</span><span class="delimiter">&quot;</span></span>, <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="key"><span class="delimiter">&quot;</span><span class="content">dependencies</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">@zetapush/cli</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">^v0.37.1</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">@zetapush/core</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">^v0.37.1</span><span class="delimiter">&quot;</span></span>, <i class="conum" data-value="3"></i><b>(3)</b>
  }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Entry point of your <a href="#_worker">worker</a>. In this file you will expose your <em>custom cloud services</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Dependency to the <a href="#_command_line_interface_cli">CLI</a> (Command Line Interface). Use it to run your worker or deploy your code.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Dependency to the <em>ZetaPush Core</em> to write some <em>custom cloud services</em></td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="_path_to_the_code"><a class="anchor" href="#_path_to_the_code"></a>Path to the code</h6>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
By convention, ZetaPush Celtia considers that your front code is in the directory <code>front</code> and your back end code (worker) in <code>worker</code>. You can change it by setting the path in the <code>package.json</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here is an example of application where the front code is in the directory <code>front/dist</code> and the back code in <code>server</code>:</p>
</div>
<div class="listingblock">
<div class="title">package.json</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td>
  <td class="code"><pre>{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">myApp</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">main</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">worker/index.ts</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">dependencies</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">@zetapush/core</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">^v0.37.1</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">@zetapush/cli</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">^v0.37.1</span><span class="delimiter">&quot;</span></span>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">zetapush</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">front</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">./front/dist</span><span class="delimiter">&quot;</span></span>, <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">worker</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">./server</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="2"></i><b>(2)</b>
  }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The front code to deploy is in the directory <code>front/dist</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The back code to deploy is in the directory <code>server</code></td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Once your package.json is ready, install the dependencies by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm install</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_zetarc"><a class="anchor" href="#_zetarc"></a>.zetarc</h5>
<div class="paragraph">
<p>To specify which account (on the ZetaPush platform) you use for an application, you fill the file <code>.zetarc</code> with the account information.</p>
</div>
<div class="paragraph">
<p>This file is in <strong>JSON</strong> format. The minimal properties are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>developerLogin</em>: Login of the developer account on the ZetaPush platform</p>
</li>
<li>
<p><em>developerPassword</em>: Password of the developer account on the ZetaPush platform</p>
</li>
<li>
<p><em>appName</em>: The name of your application</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">.zetarc</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre>{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerLogin</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">user@gmail.com</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">developerPassword</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">appName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">myAppName</span><span class="delimiter">&quot;</span></span>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you want to create a new application, you can leave the <em>appName</em> property empty, this will create a new application and fill your <em>.zetarc</em> when you will run or deploy your code.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_front"><a class="anchor" href="#_front"></a>front</h5>
<div class="paragraph">
<p>By convention, the <code>front</code> directory contains the front code (web page or web application). For example you can have this tree structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">└── front
    ├── index.html
    └── index.js</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_basic_example_of_hello_world_calling_custom_cloud_service"><a class="anchor" href="#_basic_example_of_hello_world_calling_custom_cloud_service"></a>Basic example of Hello World (calling custom cloud service)</h6>
<div class="listingblock">
<div class="title">front/index.html</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
</pre></td>
  <td class="code"><pre><span class="doctype">&lt;!DOCTYPE html&gt;</span>
<span class="tag">&lt;html</span> <span class="attribute-name">lang</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

<span class="tag">&lt;head&gt;</span>
  <span class="tag">&lt;meta</span> <span class="attribute-name">charset</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
  <span class="tag">&lt;meta</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">viewport</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">width=device-width, initial-scale=1.0</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
  <span class="tag">&lt;title&gt;</span>ZetaPush SDK Examples - Worker<span class="tag">&lt;/title&gt;</span>
  <span class="tag">&lt;style&gt;</span>
<span class="inline">    <span class="tag">body</span> {
      <span class="key">font-family</span>: <span class="value">Arial</span>, <span class="value">Helvetica</span>, <span class="value">sans-serif</span>;
    }
    <span class="tag">body</span><span class="pseudo-class">::before</span> {
      <span class="key">display</span>: <span class="value">block</span>;
      <span class="key">content</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Open Your Console</span><span class="delimiter">&quot;</span></span>;
      <span class="key">background</span>: <span class="color">#000</span>;
      <span class="key">color</span>: <span class="color">#FFF</span>;
      <span class="key">position</span>: <span class="value">fixed</span>;
      <span class="key">transform</span>: <span class="error">r</span><span class="error">o</span><span class="error">t</span><span class="error">a</span><span class="error">t</span><span class="error">e</span>(<span class="float">45deg</span>) <span class="error">t</span><span class="error">r</span><span class="error">a</span><span class="error">n</span><span class="error">s</span><span class="error">l</span><span class="error">a</span><span class="error">t</span><span class="error">e</span>(<span class="float">60px</span>, <span class="float">0px</span>);
      <span class="key">right</span>: <span class="float">0</span>;
      <span class="key">top</span>: <span class="float">0</span>;
      <span class="key">height</span>: <span class="float">25px</span>;
      <span class="key">padding</span>: <span class="float">5px</span> <span class="float">30px</span>;
      <span class="key">line-height</span>: <span class="float">25px</span>;
      <span class="key">font-family</span>: <span class="value">Calibri</span>, <span class="value">Helvetica</span>, <span class="value">Arial</span>;
      <span class="key">font-weight</span>: <span class="value">bold</span>;
    }
    <span class="tag">nav</span> {
      <span class="key">display</span>: <span class="value">flex</span>;
      <span class="key">flex-direction</span>: <span class="value">column</span>;
    }
    <span class="tag">button</span>,
    <span class="tag">label</span> {
      <span class="key">margin</span>: <span class="float">0.5</span><span class="value">rem</span> <span class="float">1</span><span class="value">rem</span>;
      <span class="key">height</span>: <span class="float">5</span><span class="value">vh</span>;
      <span class="key">font-size</span>: <span class="error">c</span><span class="error">a</span><span class="error">l</span><span class="error">c</span>(<span class="float">5</span><span class="value">vh</span> / <span class="float">2</span>);
      <span class="key">background</span>: <span class="error">l</span><span class="error">i</span><span class="error">n</span><span class="error">e</span><span class="error">a</span><span class="error">r</span><span class="error">-</span><span class="error">g</span><span class="error">r</span><span class="error">a</span><span class="error">d</span><span class="error">i</span><span class="error">e</span><span class="error">n</span><span class="error">t</span>(<span class="color">rgb(216, 216, 216)</span>, <span class="color">rgb(186, 186, 186)</span>);
      <span class="key">border-color</span>: <span class="color">rgb(117, 117, 117)</span> <span class="color">rgb(107, 107, 107)</span> <span class="color">rgb(97, 97, 97)</span>;
      <span class="key">border-style</span>: <span class="value">solid</span>;
      <span class="key">border-width</span>: <span class="float">1px</span>;
      <span class="key">padding</span>: <span class="float">1px</span> <span class="float">7px</span> <span class="float">2px</span>;
      <span class="key">text-align</span>: <span class="value">center</span>;
      <span class="key">cursor</span>: <span class="value">pointer</span>;
      <span class="key">box-sizing</span>: <span class="value">border-box</span>;
      <span class="key">align-items</span>: <span class="value">flex-start</span>;
    }
    <span class="tag">button</span>[<span class="attribute-name">disabled</span>],
    <span class="tag">label</span>[<span class="attribute-name">disabled</span>] {
      <span class="key">opacity</span>: <span class="float">0.9</span>;
      <span class="key">pointer-events</span>: <span class="value">none</span>;
      <span class="key">cursor</span>: <span class="value">not-allowed</span>;
      <span class="key">color</span>: <span class="value">graytext</span>;
    }</span>
  <span class="tag">&lt;/style&gt;</span>
<span class="tag">&lt;/head&gt;</span>

<span class="tag">&lt;body&gt;</span>
  <span class="tag">&lt;nav&gt;</span>
    <span class="tag">&lt;button</span> <span class="attribute-name">disabled</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">js-Hello</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>hello<span class="tag">&lt;/button&gt;</span>
  <span class="tag">&lt;/nav&gt;</span>
  <span class="tag">&lt;main&gt;</span>
    <span class="tag">&lt;ul&gt;</span><span class="tag">&lt;/ul&gt;</span>
  <span class="tag">&lt;/main&gt;</span>
  <span class="tag">&lt;script</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://unpkg.com/@zetapush/client</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/script&gt;</span>  <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="tag">&lt;script</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://unpkg.com/@zetapush/platform-legacy</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/script&gt;</span>  <i class="conum" data-value="2"></i><b>(2)</b>
  <span class="tag">&lt;script</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">./index.js</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/script&gt;</span>
<span class="tag">&lt;/body&gt;</span>
<span class="tag">&lt;/html&gt;</span></pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Include the ZetaPush client in order to connect to the ZetaPush cloud</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Include the ZetaPush SDK in order to interact with the ZetaPush services</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">front/index.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
  <td class="code"><pre><span class="comment">// Create new ZetaPush Client</span>
const client = <span class="keyword">new</span> ZetaPushClient.WeakClient();   <i class="conum" data-value="1"></i><b>(1)</b>
<span class="comment">// Create a proxy to invoked worker methods</span>
const api = client.createProxyTaskService();      <i class="conum" data-value="2"></i><b>(2)</b>
<span class="comment">// Handle connection</span>
client.connect().then(() =&gt; (                     <i class="conum" data-value="3"></i><b>(3)</b>
  console.debug(<span class="string"><span class="delimiter">'</span><span class="content">onConnectionEstablished</span><span class="delimiter">'</span></span>),
  [...document.querySelectorAll(<span class="string"><span class="delimiter">'</span><span class="content">button</span><span class="delimiter">'</span></span>)].forEach((node) =&gt;
    node.removeAttribute(<span class="string"><span class="delimiter">'</span><span class="content">disabled</span><span class="delimiter">'</span></span>),
  )
));
<span class="comment">// Handle DOM events</span>
document.querySelector(<span class="string"><span class="delimiter">'</span><span class="content">.js-Hello</span><span class="delimiter">'</span></span>).addEventListener(<span class="string"><span class="delimiter">'</span><span class="content">click</span><span class="delimiter">'</span></span>, async () =&gt; {
  console.log(await api.hello());                 <i class="conum" data-value="4"></i><b>(4)</b>
});</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Use ZetaPushClient factory to instantiate a client. In this example, we ask for an anonymous connection (it means that actions are not bound to a particular user of your application)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Custom cloud service provides some functions that can be called from a client. For example, the custom cloud service exposes a <code>hello</code> function.
Instead of having to write the signature of the function in the client too, we simply use a JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy">Proxy</a>.
Therefore, you can directly interact with your custom cloud service without writing any pass-through code on the client side.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The client is ready, now connect it to the ZetaPush cloud. Once the connection is established, the Promise is resolved and you can write some code in <code>then</code> callback.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>On each click on the button, the code <code>api.hello()</code> is called. It sends a message through the previously opened connection to the ZetaPush cloud. The ZetaPush cloud routes the message
to the worker that contains the custom cloud service. The function <code>hello()</code> defined in the custom cloud service is called and returns a result.
The result of this called in then sent back to the client. In this example, the result is displayed in the web browser console (using <code>console.log</code>).</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As you can see, there is no information about your application at all in this sample code (the <code>appName</code> defined in <code>.zetarc</code> is neither in HTML nor in JavaScript).
However, in order to interact with your application through the ZetaPush cloud, you need to provide the <code>appName</code>.</p>
</div>
<div class="paragraph">
<p>The ZetaPush <em>CLI</em> automatically injects the <code>appName</code> from <code>.zetarc</code>.</p>
</div>
<div class="paragraph">
<p>When you run your project locally, the local HTTP server that exposes the HTML page is lightly modified to include the <code>appName</code>.
This information is then automatically read by the ZetaPush client.</p>
</div>
<div class="paragraph">
<p>When your project is run in the cloud, the same principle is applied.</p>
</div>
<div class="paragraph">
<p>This way, you just use <code>.zetarc</code> file for your credentials and <code>appName</code> and avoid having to write them twice. This also avoids conflicts when you work
in team if you want different ZetaPush <code>appName</code> per developer.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_worker"><a class="anchor" href="#_worker"></a>worker</h5>
<div class="paragraph">
<p>By convention, the directory <code>worker</code> contains the back code (algorithms, business logic, &#8230;&#8203;). For example you can have this tree structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">└── worker
    └── index.ts    <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The file that contains the declaration of the custom cloud service</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There is one main file by worker. By default, this is index.ts but you can change this in the <code>package.json</code> file (property <code>main</code>).</p>
</div>
<div class="sect5">
<h6 id="_basic_example_of_hello_world_custom_cloud_service"><a class="anchor" href="#_basic_example_of_hello_world_custom_cloud_service"></a>Basic example of Hello World (custom cloud service)</h6>
<div class="paragraph">
<p>Here is the most simple sample to show how to declare a custom cloud service:</p>
</div>
<div class="listingblock">
<div class="title">worker/index.ts</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
</pre></td>
  <td class="code"><pre>export default class Api {                                    <i class="conum" data-value="1"></i><b>(1)</b>
  /**
   * Get an Hello World string with server side timestamp value
   */
  hello() {                                                   <i class="conum" data-value="2"></i><b>(2)</b>
    return `Hello World from JavaScript ${Date.now()}`;       <i class="conum" data-value="3"></i><b>(3)</b>
  }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>You export a <code>class</code> with the name you want.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>You define a custom cloud function just by writing a normal function. This example has no parameters but you could have any parameters you want.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>You can write any code you want and return a value (or not).
In this sample, the function is synchronous but you could also return a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a>
or even use <a href="https://javascript.info/async-await">async/await syntax</a>.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>export</code> is the standard way to make anything importable in an other file in TypeScript. You need to export your class so ZetaPush can import it and instantiate it.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_develop_your_front_with_zetapush"><a class="anchor" href="#_develop_your_front_with_zetapush"></a>Develop your front with ZetaPush</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You may want to quickly provide a web application by just focusing on the visible part and the user experience
instead of wasting time on technical concerns.</p>
</div>
<div class="paragraph">
<p>ZetaPush provides built-in <em>cloud services</em> to increase your productivity:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. List of ZetaPush cloud services</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Cloud service</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./reference.html#_standard_user_workflow">Standard User Workflow</a></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The <code>StandardUserWorkflow</code> corresponds to the most common inscription process on the Internet. It handles:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Inscription of your end-users into your application: the user fills some information and <code>StandardUserWorkflow</code> sends an email
(or SMS or anything else) to the user in order to confirm its account. Once the user has confirmed its account, he can authenticate
himself and he is ready to use your application.</p>
</li>
<li>
<p>Authentication of your end-users</p>
</li>
<li>
<p>Lost password of your end-users: the user ask for resetting its password. <code>StandardUserWorkflow</code> sends an email (or SMS or anything else) to the user.
The user clicks the link in the email to choose another password. Once confirmed, its account is updated with the new password.</p>
</li>
<li>
<p>Profile edition: your end-users can update their information</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./reference.html#_user_management">User management</a></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>This section describes several services that provide basic user management functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="./reference.html#_simple">Simple</a>: cloud functions to create a user, change credentials of a user, update a user or delete a user.</p>
</li>
<li>
<p><a href="./reference.html#_weak">Weak</a>: cloud functions to control and release of weakly authenticated user sessions.</p>
</li>
<li>
<p><a href="./reference.html#_userdir">Userdir</a>: cloud functions to retrieve and search users created by Simple.</p>
</li>
<li>
<p><a href="./reference.html#_groups">Groups</a>: cloud functions to handle group of users.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This APIs are available if <code>StandardUserWorkflow</code> doesn&#8217;t fit your needs or you want to go further.
Under the hood, <code>StandardUserWorkflow</code> use these services.</p>
</div>
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./reference.html#_data_management">Data management</a></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>This section describes several services that provide basic data management functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="./reference.html#_gda">Gda</a>: NoSQL database that can store values, objects and arrays as document in columns.</p>
</li>
<li>
<p><a href="./reference.html#_stack">Stack</a>: Store values, objects and arrays in a stack. Each item is pushed in the stack and can be accessed later.</p>
</li>
<li>
<p><a href="./reference.html#_search_2">Search</a>: Search engine to make full text searches.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./reference.html#_file_management">File management</a></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>This section describes several services that provide basic file management functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="./reference.html#_zpfs_hdfs">Zpfs_hdfs</a>: Store files on a file system.</p>
</li>
<li>
<p><a href="./reference.html#_template">Template</a>: Define a template and then evaluate it with an execution context.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./reference.html#_communication">Communication</a></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>It is possible to interact with your end-users using these services:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="./reference.html#_messaging">Messaging</a>: Send messages to a particular user (or a group of users). This is the service you use for a chat.</p>
</li>
<li>
<p><a href="./reference.html#_notif">Notif</a>: Send notifications to your end-users mobile phone (Android, iOS or Windows Phone).</p>
</li>
<li>
<p><a href="./reference.html#_sendmail">Sendmail</a>: Send emails to your end-users.</p>
</li>
<li>
<p><a href="./reference.html#_sms_ovh">Sms_ovh</a>: Send SMS to your end-users.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="./reference.html#_utilities_management">Utilities</a></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>This section provides some utility tools:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="./reference.html#_cron">Cron</a>: Schedule a task to be executed periodically.</p>
</li>
<li>
<p><a href="./reference.html#_logs">Logs</a>: Log some information. Logs will be available on ZetaPush cloud.</p>
</li>
<li>
<p><a href="./reference.html#_trigger">Trigger</a>: Listen to some event that is triggered by ZetaPush cloud and react to that event.</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>ZetaPush cloud services need to be "created" before being able to use them. This way, you
can choose which services are part of your application instead of having them all.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Currently, using a front to interact with ZetaPush cloud services directly is not really possible due to
this "creation" phase. For security reasons, service creation and configuration can&#8217;t be done via
a client.</p>
</div>
<div class="paragraph">
<p>When the web console will be fully ready, ZetaPush cloud services "creation" will be
available through the web console.</p>
</div>
<div class="paragraph">
<p>Hopefully, you can use a worker to declare the use of a ZetaPush cloud service and even configure it. The
"creation" process is automatically handled by the worker.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_requirements_2"><a class="anchor" href="#_requirements_2"></a>Requirements</h3>
<div class="paragraph">
<p>To use services (custom or not), you need to install the ZetaPush Core dependency (<code>@zetapush/client</code>).</p>
</div>
<div class="paragraph">
<p>So you can install it with:</p>
</div>
<div class="listingblock">
<div class="title">Install @zetapush/client via npm</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>$ npm install @zetapush/client</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="title">Install @zetapush/client via unpkg</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">&lt;script src=&quot;https://unpkg.com/@zetapush/client&quot;&gt;&lt;/script&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_use_em_cloud_services_em"><a class="anchor" href="#_use_em_cloud_services_em"></a>Use <em>cloud services</em></h3>
<div class="sect3">
<h4 id="_use_a_zetapush_em_cloud_service_em"><a class="anchor" href="#_use_a_zetapush_em_cloud_service_em"></a>Use a ZetaPush <em>cloud service</em></h4>
<div class="paragraph">
<p>Here we show how to create a worker that use the ZetaPush cloud service named <code>Stack</code>.</p>
</div>
<div class="paragraph">
<p>In this example, we will use the <code>Stack</code> <em>cloud service</em> provided by ZetaPush.
In our use-case, we want to put some data associated with the current timestamp and be able to list all stored data.</p>
</div>
<div class="paragraph">
<p>For this the <code>Stack</code> service provides some methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>push({ <em>stack</em>: string, <em>data</em>: object });</code></p>
</li>
<li>
<p><code>list({ <em>stack</em>: string });</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>Stack</code> service has asynchronous methods
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">MyStorageService</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td>
  <td class="code"><pre>import { Injectable } from '@zetapush/core';
import { Stack } from '@zetapush/platform-legacy';  <i class="conum" data-value="1"></i><b>(1)</b>

@Injectable()
export default class MyStorageService {
  private stackName = 'stack-example';

  constructor(private stack: Stack) {}              <i class="conum" data-value="2"></i><b>(2)</b>

  /**
   *  Store data with associated timestamp
   */
  storeWithTimestamp(value: any) {
    return this.stack.push({                        <i class="conum" data-value="3"></i><b>(3)</b>
      stack: this.stackName,
      data: {
        value,
        timestamp: Date.now()
      }
    });
  }

  /**
   * List all stored data
   */
  getAllData() {
    return this.stack.list({                        <i class="conum" data-value="4"></i><b>(4)</b>
      stack: this.stackName
    });
  }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We import the <code>Stack</code> service so that TypeScript knows it</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We ask ZetaPush to inject a dependency of type <code>Stack</code> (<code>stack</code> is an instance of <code>Stack</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Call <code>Stack</code> service to store data (method <code>push</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Call <code>Stack</code> service to list data (method <code>list</code>)</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>Stack</code> cloud service "creation" is automatically handled thanks to dependency injection.
ZetaPush detects that you need a ZetaPush service and prepare it.
so you focus your code on the usage of the service
not on its creation, you just ask for it.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">front/index.html</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td>
  <td class="code"><pre><span class="doctype">&lt;!DOCTYPE html&gt;</span>
<span class="tag">&lt;html</span> <span class="attribute-name">lang</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;head&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">charset</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">viewport</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">width=device-width, initial-scale=1.0</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;title&gt;</span>Celtia<span class="tag">&lt;/title&gt;</span>
  <span class="tag">&lt;/head&gt;</span>

  <span class="tag">&lt;body&gt;</span>
    <span class="tag">&lt;input</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">text</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">text</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>                               <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tag">&lt;button</span> <span class="attribute-name">onclick</span>=<span class="string"><span class="delimiter">&quot;</span>storeData()<span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>store data<span class="tag">&lt;/button&gt;</span>             <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tag">&lt;button</span> <span class="attribute-name">onclick</span>=<span class="string"><span class="delimiter">&quot;</span>displayAll()<span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>display all<span class="tag">&lt;/button&gt;</span>           <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="tag">&lt;ul</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">results</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/ul&gt;</span>                                        <i class="conum" data-value="4"></i><b>(4)</b>

    <span class="tag">&lt;script</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://unpkg.com/@zetapush/client</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/script&gt;</span>    <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="tag">&lt;script</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">./index.js</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/script&gt;</span>
  <span class="tag">&lt;/body&gt;</span>
<span class="tag">&lt;/html&gt;</span>
</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A simple input to fill some text to send to our cloud service</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Each time the button is clicked, it calls <code>storeData()</code> defined in <code>index.js</code> which in turns calls our <em>custom cloud service</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Each time the button is clicked, it calls <code>displayAll()</code> defined in <code>index.js</code> which in turns calls our <em>custom cloud service</em></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>A container for all results</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Dependency to ZetaPush client</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally, we have the front-side code call our services:</p>
</div>
<div class="listingblock">
<div class="title">front/index.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td>
  <td class="code"><pre><span class="comment">// Create new ZetaPush Client</span>
const client = <span class="keyword">new</span> ZetaPushClient.WeakClient();             <i class="conum" data-value="1"></i><b>(1)</b>
<span class="comment">// Create a proxy to invoked worker methods</span>
const api = client.createProxyTaskService();                <i class="conum" data-value="2"></i><b>(2)</b>
<span class="comment">// Handle connection</span>
client.connect().then(                                      <i class="conum" data-value="3"></i><b>(3)</b>
  () =&gt; (
    console.debug(<span class="string"><span class="delimiter">'</span><span class="content">onConnectionEstablished</span><span class="delimiter">'</span></span>),
    [...document.querySelectorAll(<span class="string"><span class="delimiter">'</span><span class="content">button</span><span class="delimiter">'</span></span>)].forEach((node) =&gt; node.removeAttribute(<span class="string"><span class="delimiter">'</span><span class="content">disabled</span><span class="delimiter">'</span></span>))
  )
);
const storeData = async <span class="keyword">function</span>() {
  const text = document.getElementById(<span class="string"><span class="delimiter">'</span><span class="content">text</span><span class="delimiter">'</span></span>).value;
  await api.storeWithTimestamp(text);                       <i class="conum" data-value="4"></i><b>(4)</b>
  document.getElementById(<span class="string"><span class="delimiter">'</span><span class="content">text</span><span class="delimiter">'</span></span>).value = <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>;
};
const displayAll = async <span class="keyword">function</span>() {
  const response = await api.getAllData();                  <i class="conum" data-value="5"></i><b>(5)</b>
  let resultsAsStr = <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>;
  <span class="keyword">for</span> (let result of response.result.content) {
    resultsAsStr += <span class="error">`</span><span class="tag">&lt;li&gt;</span>${JSON.stringify(result.data)}<span class="tag">&lt;/li&gt;</span><span class="error">`</span>;
  }
  document.getElementById(<span class="string"><span class="delimiter">'</span><span class="content">results</span><span class="delimiter">'</span></span>).innerHTML = resultsAsStr;
};
</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create the ZetaPush client</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>API to access our custom service(s)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Connect to the ZetaPush cloud</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Call our <em>cloud function</em> named <code>storeWithTimestamp</code> to store a new text</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Call our <em>cloud function</em> named <code>getAllData</code> and display all the results</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
When you call a <em>cloud function</em> from the client, the result is always a Promise even if the <em>custom cloud function</em> is synchronous
because everything goes through the network.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_use_a_custom_em_cloud_service_em"><a class="anchor" href="#_use_a_custom_em_cloud_service_em"></a>Use a custom <em>cloud service</em></h4>
<div class="paragraph">
<p>An example is worth a thousand words, so here is an example of usage of services.</p>
</div>
<div class="paragraph">
<p>In our example we use this <em>custom cloud service</em> named <code>HelloService</code>:</p>
</div>
<div class="listingblock">
<div class="title">worker/index.ts</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre>export default class HelloService {       <i class="conum" data-value="1"></i><b>(1)</b>
  hello() {                               <i class="conum" data-value="2"></i><b>(2)</b>
    return `Hello World`;                 <i class="conum" data-value="3"></i><b>(3)</b>
  }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The service is exported in roder to be instantiated by ZetaPush <em>CLI</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>A <em>custom cloud function</em> name <code>hello</code> is defined in this <em>custom cloud service</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <em>custom cloud function</em> simply returns a message. You can write any code you want here.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A <em>custom cloud service</em> can have as many <em>custom cloud functions</em> as you want.</p>
</div>
<div class="paragraph">
<p>A <em>custom cloud function</em> can have as many parameters as you want.</p>
</div>
<div class="paragraph">
<p>A <em>custom cloud function</em> can return anything including a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a>.
You can also write your code using <a href="https://javascript.info/async-await">async/await syntax</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now we create the HTML page with a button to display the <em>HelloWorld</em> message in the console:</p>
</div>
<div class="listingblock">
<div class="title">front/index.html</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td>
  <td class="code"><pre><span class="doctype">&lt;!DOCTYPE html&gt;</span>
<span class="tag">&lt;html</span> <span class="attribute-name">lang</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

<span class="tag">&lt;head&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">charset</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">viewport</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">width=device-width, initial-scale=1.0</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;title&gt;</span>Celtia<span class="tag">&lt;/title&gt;</span>
<span class="tag">&lt;/head&gt;</span>

<span class="tag">&lt;body&gt;</span>
    <span class="tag">&lt;button</span> <span class="attribute-name">onclick</span>=<span class="string"><span class="delimiter">&quot;</span>hello()<span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>hello<span class="tag">&lt;/button&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tag">&lt;ul&gt;</span><span class="tag">&lt;/ul&gt;</span>

    <span class="tag">&lt;script</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://unpkg.com/@zetapush/client</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/script&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tag">&lt;script</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">./index.js</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/script&gt;</span>
<span class="tag">&lt;/body&gt;</span>

<span class="tag">&lt;/html&gt;</span></pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We call <code>hello()</code>, which in turns calls our <em>custom cloud service</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Dependency to ZetaPush Core</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally, we have the front-side code call our services:</p>
</div>
<div class="listingblock">
<div class="title">front/index.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
  <td class="code"><pre><span class="comment">// Create new ZetaPush Client</span>
const client = <span class="keyword">new</span> ZetaPushClient.WeakClient();     <i class="conum" data-value="1"></i><b>(1)</b>
<span class="comment">// Create a proxy to invoked worker methods</span>
const api = client.createProxyTaskService();        <i class="conum" data-value="2"></i><b>(2)</b>
<span class="comment">// Handle connection</span>
client.connect().then(() =&gt; (                       <i class="conum" data-value="3"></i><b>(3)</b>
  console.debug(<span class="string"><span class="delimiter">'</span><span class="content">onConnectionEstablished</span><span class="delimiter">'</span></span>),
  [...document.querySelectorAll(<span class="string"><span class="delimiter">'</span><span class="content">button</span><span class="delimiter">'</span></span>)].forEach((node) =&gt;
    node.removeAttribute(<span class="string"><span class="delimiter">'</span><span class="content">disabled</span><span class="delimiter">'</span></span>),
  )
));
<span class="comment">// Handle DOM events</span>
document.querySelector(<span class="string"><span class="delimiter">'</span><span class="content">.js-Hello</span><span class="delimiter">'</span></span>).addEventListener(<span class="string"><span class="delimiter">'</span><span class="content">click</span><span class="delimiter">'</span></span>, async () =&gt; {
  console.log(await api.hello());                   <i class="conum" data-value="4"></i><b>(4)</b>
});</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create the ZetaPush client (using automatic injection of <code>appName</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>API to access our custom service(s)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Connection to the ZetaPush platform</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Call our <em>cloud function</em> and display the result</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Now when we click the button, "Hello World" is displayed on the page.</strong></p>
</div>
<div class="imageblock center">
<div class="content">
<img src="call-zetapush-cloud-service.png" alt="call zetapush cloud service" width="739" height="431">
</div>
<div class="title">Figure 1. How it works ?</div>
</div>
<div class="paragraph">
<p>When you start your project locally, the first thing that happens is that your worker connects himself automatically to the ZetaPush cloud [1][2].</p>
</div>
<div class="paragraph">
<p>Then when you open your web browser, the connection from the client is established between the web page and the ZetaPush cloud [3][4].</p>
</div>
<div class="paragraph">
<p>When you click on the button, a message is sent through the opened connection in order to tell ZetaPush cloud to execute some
remote code [5]. ZetaPush cloud routes the message to your worker [6] (that is running on your machine here). The worker receives the message
and calls the <code>hello</code> <em>cloud function</em> [7].</p>
</div>
<div class="paragraph">
<p>The <em>cloud function</em> generates a result [8]. The worker picks this result and transform it to a message [9]. This message is then sent
to the ZetaPush cloud [10]. The ZetaPush cloud routes the response message to the calling client [11]. The client receives the message
and the response is parsed [12] and available in your JavaScript.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
When you call a <em>cloud function</em> from the client, the result is always a Promise even if the <em>custom cloud function</em> is synchronous
because everything goes through the network.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configure_adapt_zetapush_cloud_services"><a class="anchor" href="#_configure_adapt_zetapush_cloud_services"></a>Configure/adapt ZetaPush cloud services</h3>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>This section will describe how to configure a ZetaPush cloud service.
The configuration will be possible either through console or through worker.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/zetapush/documentation/issues/51" class="bare">https://github.com/zetapush/documentation/issues/51</a></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_run_your_front_locally"><a class="anchor" href="#_run_your_front_locally"></a>Run your front locally</h3>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>As described above, currently running only a front is not possible.
You need to have a least worker to create and configure ZetaPush services.</p>
</div>
<div class="paragraph">
<p>This section will be later described when this feature will be supported.
<a href="https://github.com/zetapush/documentation/issues/52" class="bare">https://github.com/zetapush/documentation/issues/52</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_develop_your_business_logic"><a class="anchor" href="#_develop_your_business_logic"></a>Develop your business logic</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_what_is_a_em_custom_cloud_service_em"><a class="anchor" href="#_what_is_a_em_custom_cloud_service_em"></a>What is a <em>custom cloud service</em></h3>
<div class="paragraph">
<p>A <em>custom cloud service</em> combines many <em>cloud functions</em> like the <em>cloud services</em> exposed by ZetaPush. The only difference is that <strong>you</strong> create the <em>cloud functions</em>.
Generally, you will want to put the <strong>business logic</strong> of your application in the <em>custom cloud services</em>.</p>
</div>
<div class="sect3">
<h4 id="_architecture"><a class="anchor" href="#_architecture"></a>Architecture</h4>
<div class="sect4">
<h5 id="_development_phase"><a class="anchor" href="#_development_phase"></a>Development phase</h5>
<div class="imageblock center">
<div class="content">
<img src="custom-cloud-service-dev.png" alt="custom cloud service dev" width="946" height="591">
</div>
<div class="title">Figure 2. Custom Cloud Service in development phase</div>
</div>
<div class="paragraph">
<p>The worker is running "locally" and interacts with the existing <em>cloud services</em> on the ZetaPush platform and the front code interacts <strong>only</strong> with the <em>custom cloud services</em> that are running "locally"</p>
</div>
</div>
<div class="sect4">
<h5 id="_production_phase"><a class="anchor" href="#_production_phase"></a>Production phase</h5>
<div class="imageblock center">
<div class="content">
<img src="custom-cloud-service-prod.png" alt="custom cloud service prod" width="744" height="251">
</div>
<div class="title">Figure 3. Custom Cloud Service in production phase</div>
</div>
<div class="paragraph">
<p>The front code interacts <strong>only</strong> with the <em>custom cloud services</em> that are running "remotely"</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_define_a_em_custom_cloud_service_em"><a class="anchor" href="#_define_a_em_custom_cloud_service_em"></a>Define a <em>custom cloud service</em></h3>
<div class="paragraph">
<p>First, a <em>custom cloud service</em> is a <code>class</code> and its <code>methods</code> are the  <em>cloud functions</em>. So the most basic example of a <em>custom cloud service</em> is below:</p>
</div>
<div class="sect3">
<h4 id="_create_a_em_cloud_function_em"><a class="anchor" href="#_create_a_em_cloud_function_em"></a>Create a <em>cloud function</em></h4>
<div class="listingblock">
<div class="title">Basic custom cloud service</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
</pre></td>
  <td class="code"><pre><span class="reserved">class</span> HelloWorldAsCustomCloudService {

    constructor() {} <i class="conum" data-value="1"></i><b>(1)</b>

    helloWorld() { <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello World</span><span class="delimiter">&quot;</span></span>;
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>You always need to add a constructor in a <em>custom cloud service</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>helloWorld</code> is your first <em>cloud function</em> in your <em>custom cloud service</em> named <strong>HelloWorldAsCustomCloudService</strong></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A <em>cloud function</em> is always asynchronous (with the <em>async</em> keyword or not)
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each <em>cloud function</em> in a <em>custom cloud service</em> must follow a specific format.
Only the first parameter is passed, the second is the context of the call.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
</pre></td>
  <td class="code"><pre><span class="reserved">class</span> myCustomCloudService {
    constructor() {}

    myCloudFunction(parameters, context) { <i class="conum" data-value="1"></i><b>(1)</b>
        ...
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>parameters</code> is the first argument passed, it can be an object.
<code>context</code> is the context of the call for this <em>cloud function</em>.
For example you can get the ID of the caller with <code>context.owner</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>On the front side, you can use this <em>cloud function</em> like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
</pre></td>
  <td class="code"><pre><span class="local-variable">this</span>.api.myCloudFunction({ <span class="key"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>: <span class="string"><span class="delimiter">'</span><span class="content">toto</span><span class="delimiter">'</span></span>});
<span class="comment">// Or this.api.myCloudFunction('titi');</span></pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_expose_a_em_custom_cloud_service_em"><a class="anchor" href="#_expose_a_em_custom_cloud_service_em"></a>Expose a <em>custom cloud service</em></h4>
<div class="paragraph">
<p>When you create a <em>custom cloud service</em> that you want to expose to the client, you need to declare it. You have 2 cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Only one <em>custom cloud service</em> exposed</p>
</li>
<li>
<p>Many <em>custom cloud services</em> exposed</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>package.json</code> has a property named <code>main</code>. It defines the file where the <em>custom cloud services</em> are exposed. The following examples define them in <code>worker/index.ts</code>.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_namespace"><a class="anchor" href="#_namespace"></a>Namespace</h5>
<div class="paragraph">
<p>When you call a <em>cloud function</em> from a <em>custom cloud service</em>, you can specify a <em>namespace</em> (if you have 2 <em>cloud functions</em> on 2 differents <em>custom cloud services</em>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <em>namespace</em> is never used inside the <em>custom cloud service</em>. The <em>namespace</em> is defined when you expose your <em>custom cloud service</em>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example we have this service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td>
  <td class="code"><pre><span class="reserved">class</span> Api {
    constructor() {}

    hello(name, context) { <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="keyword">return</span> <span class="error">`</span>Hello <span class="predefined">$</span>{name} called by <span class="predefined">$</span>{context.owner}.<span class="error">`</span>;
    }
}

module.exports = {
    <span class="key">api</span>: Api <i class="conum" data-value="2"></i><b>(2)</b>
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <em>namespace</em> is never passed here</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We export this <em>custom cloud service</em> with the namespace 'api'</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can call <code>hello()</code> like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
</pre></td>
  <td class="code"><pre><span class="comment">// api is an instance of Api</span>
<span class="local-variable">this</span>.api.hello(<span class="string"><span class="delimiter">'</span><span class="content">Toto</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">api</span><span class="delimiter">'</span></span>); <i class="conum" data-value="1"></i><b>(1)</b></pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>We use the method <code>hello()</code> from the namespace <em>api</em>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_only_one_custom_cloud_service_exposed"><a class="anchor" href="#_only_one_custom_cloud_service_exposed"></a>Only one custom cloud service exposed</h5>
<div class="paragraph">
<p>In this example, we have 2 <em>custom cloud services</em>: One is private and the second is exposed:</p>
</div>
<div class="listingblock highlight-lines:15">
<div class="title">worker/index.ts</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td>
  <td class="code"><pre>import { Injectable } from '@zetapush/core';

class Calendar { <i class="conum" data-value="1"></i><b>(1)</b>
  getNow() {
    return new Date().toLocaleDateString();
  }
}

@Injectable()
export default class MyPublicCustomCloudService { <i class="conum" data-value="2"></i><b>(2)</b>
  constructor(
    private calendar: Calendar
  ) {}
  hello() {
    return `Hello World at ${this.calendar.getNow()}`;
  }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>Calendar</code> is my private <em>custom cloud service</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We expose only <code>MyPublicCustomCloudService</code> to the client side</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_many_custom_cloud_services_exposed"><a class="anchor" href="#_many_custom_cloud_services_exposed"></a>Many custom cloud services exposed</h5>
<div class="paragraph">
<p>In this example, we want to expose 2 <em>custom cloud services</em>. In this case, we need to specify the namespace of each <em>custom cloud service</em>:</p>
</div>
<div class="listingblock highlight-lines:21-22">
<div class="title">worker/index.ts</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td>
  <td class="code"><pre>import { Injectable } from '@zetapush/core';

@Injectable()
class Calendar {
  getNow() {
    return new Date().toLocaleDateString();
  }
}

@Injectable()
class HelloService {
  constructor(
    private calendar: Calendar
  ) {}
  hello() {
    return `Hello World at ${this.calendar.getNow()}`;
  }
}

export default  { <i class="conum" data-value="1"></i><b>(1)</b>
  helloService: HelloService,
  calendar: Calendar
};</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We expose the 2 <em>custom cloud services</em> to the client side with the syntax: { <em>namespace1</em>: <em>Service1</em>, <em>namespace2</em>: <em>Service2</em> }</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_dependency_injection"><a class="anchor" href="#_dependency_injection"></a>Dependency injection</h4>
<div class="paragraph">
<p>First of all, if you want to include some services (custom or not), you need to use the <em>dependency injection</em> of ZetaPush. This will ease the injection of your dependencies.</p>
</div>
<div class="paragraph">
<p>You need to import the package <code>@zetapush/core</code> in order to use <code>Injectable</code>. This object will resolve the dependency injection of <em>cloud services</em> and <em>custom cloud services</em>.</p>
</div>
<div class="listingblock">
<div class="title">Install @zetapush/core</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>$ npm install --save @zetapush/core</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The dependency injection of ZetaPush uses Angular <a href="https://github.com/mgechev/injection-js" target="_blank" rel="noopener">injection-js</a> library.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You need to import the package <code>@zetapush/platform-legacy</code> in order to use <code>Stack</code> <em>cloud services</em>.</p>
</div>
<div class="listingblock">
<div class="title">Install @zetapush/platform-legacy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>$ npm install --save @zetapush/platform-legacy</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, to import an other service, you simply need to write:</p>
</div>
<div class="listingblock highlight-lines:6">
<div class="title">Import service</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td>
  <td class="code"><pre>import { Injectable } from '@zetapush/core';
import { Stack } = require('@zetapush/platform-legacy'); <i class="conum" data-value="1"></i><b>(1)</b>
import { MyOtherService } from './services'; <i class="conum" data-value="2"></i><b>(2)</b>

@Injectable()
class MyOwnService {
    constructor(private myOtherService: MyOtherService, private stack: Stack) { <i class="conum" data-value="3"></i><b>(3)</b>
        ...
    }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We import the <code>Inject</code> object and a service (<em>Stack</em>) provided by ZetaPush</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We import an other custom cloud service</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We use instances of our injected services in our service throught the constructor</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you import a <em>custom cloud service</em> or a <em>cloud service</em> provided by ZetaPush, you use both similarily</p>
</div>
</div>
<div class="sect3">
<h4 id="_use_built_in_em_cloud_service_em"><a class="anchor" href="#_use_built_in_em_cloud_service_em"></a>Use built-in <em>cloud service</em></h4>
<div class="paragraph">
<p>Once you have imported the services, you can use them.</p>
</div>
<div class="paragraph">
<p>In this example, we will use the <code>Stack</code> <em>cloud service</em> provided by ZetaPush.
In our use-case, we want to put some data associated with the current timestamp and be able to list all stored data.</p>
</div>
<div class="paragraph">
<p>For this the <code>Stack</code> service provides some methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>push({ <em>stack</em>: string, <em>data</em>: object });</code></p>
</li>
<li>
<p><code>list({ <em>stack</em>: string });</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>Stack</code> service has asynchronous methods
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">MyStorageService</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td>
  <td class="code"><pre>import { Injectable } from '@zetapush/core';
import { Stack } from '@zetapush/platform-legacy';  <i class="conum" data-value="1"></i><b>(1)</b>

@Injectable()
export default class MyStorageService {
  private stackName = 'stack-example';

  constructor(private stack: Stack) {}              <i class="conum" data-value="2"></i><b>(2)</b>

  /**
   *  Store data with associated timestamp
   */
  storeWithTimestamp(value: any) {
    return this.stack.push({                        <i class="conum" data-value="3"></i><b>(3)</b>
      stack: this.stackName,
      data: {
        value,
        timestamp: Date.now()
      }
    });
  }

  /**
   * List all stored data
   */
  getAllData() {
    return this.stack.list({                        <i class="conum" data-value="4"></i><b>(4)</b>
      stack: this.stackName
    });
  }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We import the <code>Stack</code> service so that TypeScript knows it</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We ask ZetaPush to inject a dependency of type <code>Stack</code> (<code>stack</code> is an instance of <code>Stack</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Call <code>Stack</code> service to store data (method <code>push</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Call <code>Stack</code> service to list data (method <code>list</code>)</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_use_another_em_custom_cloud_service_em"><a class="anchor" href="#_use_another_em_custom_cloud_service_em"></a>Use another <em>custom cloud service</em></h4>
<div class="paragraph">
<p>Once you have imported the services, you can use them.</p>
</div>
<div class="paragraph">
<p>In this example, we will have 2 <em>custom cloud services</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Calendar</code>: Utils function to return the current date</p>
</li>
<li>
<p><code>HelloWorldService</code>: Basic example using <code>Calendar</code> <em>cloud function</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first <em>custom cloud service</em> (<code>Calendar</code>) is in the file: "worker/calendar.js".</p>
</div>
<div class="listingblock">
<div class="title">worker/calendar.ts</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre>export class Calendar {
  getNow() { <i class="conum" data-value="1"></i><b>(1)</b>
    return new Date().toLocalDateString('fr-FR');
  }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The only <em>cloud function</em> of the <code>Calendar</code> service</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then, we have the <code>HelloWorldService</code> that use our <code>Calendar</code> service. It is in the file: "./worker/index.ts".</p>
</div>
<div class="listingblock highlight-lines:7,13">
<div class="title">worker/index.ts</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
  <td class="code"><pre>import { Injectable } from '@zetapush/core';
import { Calendar } from './calendar'; <i class="conum" data-value="1"></i><b>(1)</b>

@Injectable()
class HelloWorldService {
  constructor( <i class="conum" data-value="2"></i><b>(2)</b>
    private calendar: Calendar
  ) {}
  /**
   * Return 'Hello World' with current date
   */
  helloWorldWithDate() {
    return `Hello world at ${this.calendar.getNow()}`;
 }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We import the <code>Calendar</code> service</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>calendar</code> is an instance of <code>Calendar</code></td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_run_a_em_custom_cloud_service_em"><a class="anchor" href="#_run_a_em_custom_cloud_service_em"></a>Run a <em>custom cloud service</em></h3>
<div class="listingblock">
<div class="title">Start custom cloud services locally</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm run start</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>npm run start</code> is a script alias defined in the <code>package.json</code> file.
The command that is executed under the hood is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ zeta run</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_use_a_em_custom_cloud_service_em_in_your_front"><a class="anchor" href="#_use_a_em_custom_cloud_service_em_in_your_front"></a>Use a <em>custom cloud service</em> in your front</h3>
<div class="paragraph">
<p>An example is worth a thousand words, so here is an example of usage of services.</p>
</div>
<div class="paragraph">
<p>In our example we use this <em>custom cloud service</em> named <code>HelloService</code>:</p>
</div>
<div class="listingblock">
<div class="title">worker/index.ts</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre>export default class HelloService {       <i class="conum" data-value="1"></i><b>(1)</b>
  hello() {                               <i class="conum" data-value="2"></i><b>(2)</b>
    return `Hello World`;                 <i class="conum" data-value="3"></i><b>(3)</b>
  }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The service is exported in roder to be instantiated by ZetaPush <em>CLI</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>A <em>custom cloud function</em> name <code>hello</code> is defined in this <em>custom cloud service</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <em>custom cloud function</em> simply returns a message. You can write any code you want here.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A <em>custom cloud service</em> can have as many <em>custom cloud functions</em> as you want.</p>
</div>
<div class="paragraph">
<p>A <em>custom cloud function</em> can have as many parameters as you want.</p>
</div>
<div class="paragraph">
<p>A <em>custom cloud function</em> can return anything including a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a>.
You can also write your code using <a href="https://javascript.info/async-await">async/await syntax</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now we create the HTML page with a button to display the <em>HelloWorld</em> message in the console:</p>
</div>
<div class="listingblock">
<div class="title">front/index.html</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td>
  <td class="code"><pre><span class="doctype">&lt;!DOCTYPE html&gt;</span>
<span class="tag">&lt;html</span> <span class="attribute-name">lang</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

<span class="tag">&lt;head&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">charset</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;meta</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">viewport</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">content</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">width=device-width, initial-scale=1.0</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;title&gt;</span>Celtia<span class="tag">&lt;/title&gt;</span>
<span class="tag">&lt;/head&gt;</span>

<span class="tag">&lt;body&gt;</span>
    <span class="tag">&lt;button</span> <span class="attribute-name">onclick</span>=<span class="string"><span class="delimiter">&quot;</span>hello()<span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>hello<span class="tag">&lt;/button&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tag">&lt;ul&gt;</span><span class="tag">&lt;/ul&gt;</span>

    <span class="tag">&lt;script</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://unpkg.com/@zetapush/client</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/script&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tag">&lt;script</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">./index.js</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/script&gt;</span>
<span class="tag">&lt;/body&gt;</span>

<span class="tag">&lt;/html&gt;</span></pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We call <code>hello()</code>, which in turns calls our <em>custom cloud service</em></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Dependency to ZetaPush Core</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally, we have the front-side code call our services:</p>
</div>
<div class="listingblock">
<div class="title">front/index.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
  <td class="code"><pre><span class="comment">// Create new ZetaPush Client</span>
const client = <span class="keyword">new</span> ZetaPushClient.WeakClient();     <i class="conum" data-value="1"></i><b>(1)</b>
<span class="comment">// Create a proxy to invoked worker methods</span>
const api = client.createProxyTaskService();        <i class="conum" data-value="2"></i><b>(2)</b>
<span class="comment">// Handle connection</span>
client.connect().then(() =&gt; (                       <i class="conum" data-value="3"></i><b>(3)</b>
  console.debug(<span class="string"><span class="delimiter">'</span><span class="content">onConnectionEstablished</span><span class="delimiter">'</span></span>),
  [...document.querySelectorAll(<span class="string"><span class="delimiter">'</span><span class="content">button</span><span class="delimiter">'</span></span>)].forEach((node) =&gt;
    node.removeAttribute(<span class="string"><span class="delimiter">'</span><span class="content">disabled</span><span class="delimiter">'</span></span>),
  )
));
<span class="comment">// Handle DOM events</span>
document.querySelector(<span class="string"><span class="delimiter">'</span><span class="content">.js-Hello</span><span class="delimiter">'</span></span>).addEventListener(<span class="string"><span class="delimiter">'</span><span class="content">click</span><span class="delimiter">'</span></span>, async () =&gt; {
  console.log(await api.hello());                   <i class="conum" data-value="4"></i><b>(4)</b>
});</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create the ZetaPush client (using automatic injection of <code>appName</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>API to access our custom service(s)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Connection to the ZetaPush platform</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Call our <em>cloud function</em> and display the result</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Now when we click the button, "Hello World" is displayed on the page.</strong></p>
</div>
<div class="imageblock center">
<div class="content">
<img src="call-zetapush-cloud-service.png" alt="call zetapush cloud service" width="739" height="431">
</div>
<div class="title">Figure 4. How it works ?</div>
</div>
<div class="paragraph">
<p>When you start your project locally, the first thing that happens is that your worker connects himself automatically to the ZetaPush cloud [1][2].</p>
</div>
<div class="paragraph">
<p>Then when you open your web browser, the connection from the client is established between the web page and the ZetaPush cloud [3][4].</p>
</div>
<div class="paragraph">
<p>When you click on the button, a message is sent through the opened connection in order to tell ZetaPush cloud to execute some
remote code [5]. ZetaPush cloud routes the message to your worker [6] (that is running on your machine here). The worker receives the message
and calls the <code>hello</code> <em>cloud function</em> [7].</p>
</div>
<div class="paragraph">
<p>The <em>cloud function</em> generates a result [8]. The worker picks this result and transform it to a message [9]. This message is then sent
to the ZetaPush cloud [10]. The ZetaPush cloud routes the response message to the calling client [11]. The client receives the message
and the response is parsed [12] and available in your JavaScript.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
When you call a <em>cloud function</em> from the client, the result is always a Promise even if the <em>custom cloud function</em> is synchronous
because everything goes through the network.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_hot_reload"><a class="anchor" href="#_hot_reload"></a>Hot reload</h3>
<div class="paragraph">
<p>TODO: <a href="https://github.com/zetapush/documentation/issues/53" class="bare">https://github.com/zetapush/documentation/issues/53</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deploy_publish_your_application"><a class="anchor" href="#_deploy_publish_your_application"></a>Deploy/publish your application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once you have developed your application and tested it, you may want to deploy it on the ZetaPush cloud.</p>
</div>
<div class="sect2">
<h3 id="_what_will_be_deployed"><a class="anchor" href="#_what_will_be_deployed"></a>What will be deployed ?</h3>
<div class="paragraph">
<p>In the <em>deployment</em> with ZetaPush, you have 2 parts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hosting and scalability of the worker (<em>custom cloud services</em>)</p>
</li>
<li>
<p>Hosting of the front end</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_worker_2"><a class="anchor" href="#_worker_2"></a>Worker</h4>
<div class="paragraph">
<p>When you deploy the worker (<em>custom cloud services</em>) of your application, we take care of the hosting of your code. In addition, we manage the scability of your application.</p>
</div>
</div>
<div class="sect3">
<h4 id="_front_end"><a class="anchor" href="#_front_end"></a>Front end</h4>
<div class="paragraph">
<p>For the front end part, we host your application and return you an unique URL to access to your application. We also link your front end logic with the differents services you need (<em>custom cloud services</em> or <em>cloud services</em> provided by ZetaPush).</p>
</div>
</div>
<div class="sect3">
<h4 id="_applications_and_environments"><a class="anchor" href="#_applications_and_environments"></a>Applications and environments</h4>
<div class="paragraph">
<p>TODO: <a href="https://github.com/zetapush/documentation/issues/54" class="bare">https://github.com/zetapush/documentation/issues/54</a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deploy_both_front_and_em_custom_cloud_services_em_on_the_zetapush_cloud"><a class="anchor" href="#_deploy_both_front_and_em_custom_cloud_services_em_on_the_zetapush_cloud"></a>Deploy both front and <em>custom cloud services</em> on the ZetaPush Cloud</h3>
<div class="paragraph">
<p>The deployment is very easy, to do this you only need to launch this command in your application directory:</p>
</div>
<div class="listingblock">
<div class="title">Deploy the application</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm run deploy</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>npm run deploy</code> is a script alias defined in the <code>package.json</code> file.
The command that is executed under the hood is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ zeta push</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The command will read the <code>.zetarc</code> file. If there is no <em>developerLogin</em> and <em>developerPassword</em> properties or if the ZetaPush account is not validated, you will not be able to push your application.</p>
</div>
<div class="paragraph">
<p>About the <em>appName</em> property, if it is empty, the CLI will deploy your code on a new application.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
When you deploy your application (Front + Worker), the CLI returns you an unique URL to use it.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_deploy_your_front_on_the_zetapush_cloud"><a class="anchor" href="#_deploy_your_front_on_the_zetapush_cloud"></a>Deploy your front on the ZetaPush Cloud</h3>
<div class="paragraph">
<p>If you want to only deploy the front part of your application on the ZetaPush platform, you can launch:</p>
</div>
<div class="listingblock">
<div class="title">Deploy the worker</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm run deploy -- --front</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>npm run deploy</code> is a script alias defined in the <code>package.json</code> file.
The command that is executed under the hood is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ zeta push --front</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In this case your worker is not deployed at all.</p>
</div>
</div>
<div class="sect2">
<h3 id="_deploy_your_em_custom_cloud_services_em_on_the_zetapush_cloud"><a class="anchor" href="#_deploy_your_em_custom_cloud_services_em_on_the_zetapush_cloud"></a>Deploy your <em>custom cloud services</em> on the ZetaPush Cloud</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <em>Worker</em> is the back end of your application. Generally you put your business logic inside it.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you want to deploy your worker only on the ZetaPush platform, you can launch:</p>
</div>
<div class="listingblock">
<div class="title">Deploy the worker</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm run deploy -- --worker</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>npm run deploy</code> is a script alias defined in the <code>package.json</code> file.
The command that is executed under the hood is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ zeta push --worker</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In this case you only deploy your back end code, so no URL will be returned.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_debug"><a class="anchor" href="#_debug"></a>Debug</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_debug_your_application_with_vscode"><a class="anchor" href="#_debug_your_application_with_vscode"></a>Debug your application with VSCode</h3>
<div class="paragraph">
<p>VSCode provide a powerfull debugging feature <a href="https://code.visualstudio.com/docs/editor/debugging" class="bare">https://code.visualstudio.com/docs/editor/debugging</a>.</p>
</div>
<div class="paragraph">
<p>Add a launch configuration with the following structure.</p>
</div>
<div class="listingblock">
<div class="title">Configure .vscode/launch.json file</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td>
  <td class="code"><pre>{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">0.2.0</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">configurations</span><span class="delimiter">&quot;</span></span>: [
    {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">zeta run</span><span class="delimiter">&quot;</span></span>, <i class="conum" data-value="1"></i><b>(1)</b>
      <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">node</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">request</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">launch</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">program</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">${workspaceRoot}/node_modules/.bin/zeta</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">stopOnEntry</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">sourceMaps</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">args</span><span class="delimiter">&quot;</span></span>: [ <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="string"><span class="delimiter">&quot;</span><span class="content">run</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">--serve-front</span><span class="delimiter">&quot;</span></span>
      ],
      <span class="key"><span class="delimiter">&quot;</span><span class="content">cwd</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">${workspaceRoot}</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">console</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">internalConsole</span><span class="delimiter">&quot;</span></span>
    }
  ]
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Launch configuration name</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>zeta command arguments</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Run VSCode debugger</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images//debug/run-vscode-debugger.png" alt="Run VSCode debugger">
</div>
</div>
<div class="paragraph">
<p>You can run Debugger by following the official  VSCode documentation: <a href="https://code.visualstudio.com/docs/editor/debugging" class="bare">https://code.visualstudio.com/docs/editor/debugging</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_debug_your_application_with_intellij_based_ide"><a class="anchor" href="#_debug_your_application_with_intellij_based_ide"></a>Debug your application with IntelliJ based IDE</h3>
<div class="paragraph">
<p>Intellij&#8217;s WebStorm provide a powerfull debugging feature <a href="https://blog.jetbrains.com/webstorm/2018/01/how-to-debug-with-webstorm/" class="bare">https://blog.jetbrains.com/webstorm/2018/01/how-to-debug-with-webstorm/</a>.</p>
</div>
<div class="paragraph">
<p>On the top menu, select Run &#8594; Edit Configurations</p>
</div>
<div class="paragraph">
<p>then select a new NodeJs Template :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Node interpreter : path to nodeJS executable.</p>
</li>
<li>
<p>Node parameters : must be "node_modules/.bin/zeta".</p>
</li>
<li>
<p>Working directory : path to your project.</p>
</li>
<li>
<p>Javascript file : should be blank.</p>
</li>
<li>
<p>Application parameters : zeta command to launch, with optionals flags.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images//debug/webstorm-debug.png" alt="Configure WebStorm Debug">
</div>
</div>
<div class="paragraph">
<p>You can now use Intellij in debug mode with breakpoints and all the debugs features.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing"><a class="anchor" href="#_testing"></a>Testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TODO: <a href="https://github.com/zetapush/documentation/issues/55" class="bare">https://github.com/zetapush/documentation/issues/55</a></p>
</div>
<div class="sect2">
<h3 id="_unit_testing_your_front"><a class="anchor" href="#_unit_testing_your_front"></a>Unit testing your front</h3>
<div class="paragraph">
<p>TODO: <a href="https://github.com/zetapush/documentation/issues/56" class="bare">https://github.com/zetapush/documentation/issues/56</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_unit_testing_your_custom_cloud_services"><a class="anchor" href="#_unit_testing_your_custom_cloud_services"></a>Unit testing your custom cloud services</h3>
<div class="paragraph">
<p>TODO: <a href="https://github.com/zetapush/documentation/issues/57" class="bare">https://github.com/zetapush/documentation/issues/57</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_integration_testing_your_front"><a class="anchor" href="#_integration_testing_your_front"></a>Integration testing your front</h3>
<div class="paragraph">
<p>TODO: <a href="https://github.com/zetapush/documentation/issues/58" class="bare">https://github.com/zetapush/documentation/issues/58</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_integration_testing_your_custom_cloud_services"><a class="anchor" href="#_integration_testing_your_custom_cloud_services"></a>Integration testing your custom cloud services</h3>
<div class="paragraph">
<p>TODO: <a href="https://github.com/zetapush/documentation/issues/59" class="bare">https://github.com/zetapush/documentation/issues/59</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_functional_testing_end_to_end_testing"><a class="anchor" href="#_functional_testing_end_to_end_testing"></a>Functional testing / end-to-end testing</h3>
<div class="paragraph">
<p>TODO: <a href="https://github.com/zetapush/documentation/issues/60" class="bare">https://github.com/zetapush/documentation/issues/60</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_of_cloud_services"><a class="anchor" href="#_configuration_of_cloud_services"></a>Configuration of cloud services</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="configuration-of-standard-user-workflow"><a class="anchor" href="#configuration-of-standard-user-workflow"></a>Standard User Workflow</h3>
<div class="paragraph">
<p>Configuration of <strong>Standard User Worflow</strong>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_extension_of_cloud_services"><a class="anchor" href="#_extension_of_cloud_services"></a>Extension of cloud services</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="extension-of-standard-user-workflow"><a class="anchor" href="#extension-of-standard-user-workflow"></a>Standard User Workflow</h3>
<div class="paragraph">
<p>Extension of <strong>Standard User Worflow</strong>.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-12-04 14:36:14 UTC
</div>
</div>
</body>
</html>