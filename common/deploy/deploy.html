<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>Deployment</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../..//javascripts/menu.js"></script>
<script type="text/javascript" src="../..//javascripts/sidebar.js"></script>
<script type="text/javascript" src="../..//javascripts/steps.js"></script>
<script type="text/javascript" src="../..//javascripts/sourcecode/source-utils.js"></script>
<script type="text/javascript" src="../..//javascripts/sourcecode/highlight-lines.js"></script>
<script type="text/javascript" src="../..//javascripts/sourcecode/collapse-lines.js"></script>
<script type="text/javascript" src="../..//javascripts/tabcontainer.js"></script>
<script type="text/javascript" src="//unpkg.com/clipboard@2.0.0/dist/clipboard.min.js"></script>
<script type="text/javascript" src="../..//javascripts/clipboard.js"></script>
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.js"></script>
<script type="text/javascript" src="../..//javascripts/search.js"></script>
<!-- <link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.2/united/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css"
  /> -->
<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,800" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="../..//styles/zetapush-styles.css" />
<link rel="stylesheet" type="text/css" href="../..//styles/custom-styles.css" />
<link rel="stylesheet" type="text/css" href="../..//styles/tabcontainer.css" />
<link rel="stylesheet" type="text/css" href="../..//styles/steps.css" />
<link rel="stylesheet" type="text/css" href="../..//styles/sourcecode/collapse-lines.css" />
<link rel="stylesheet" type="text/css" href="../..//styles/sourcecode/highlight-lines.css" />
<link rel="stylesheet" type="text/css" href="../..//styles/clipboard.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.css">
<script type="text/html" id="hit-template">
  <div class="hit">
    <div class="hit-content">
      <div class="context">
        <a href="{{sourceFile.url}}">{{sourceFile.title}}</a>
        {{#parents}}
          <a href="{{url}}">{{title}}</a>
        {{/parents}}
        <a href="{{url}}">{{{_highlightResult.title.value}}}</a>
      </div>
      <pre class="hit-description">{{{_highlightResult.content.value}}}</pre>
    </div>
  </div>
</script>
<header>
  <nav>
    <div class="main-title"><span></span><i class="fa fa-caret-down"></i></div>
    <ul>
      <li><a href="/documentation"><span>ZetaPush documentation</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/getting-started.html"><span>Getting Started</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/developer-manual.html"><span>Developer manual</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/how-to.html"><span>How to guides</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/tutorials.html"><span>Tutorials</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/reference.html"><span>Reference</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="http://docv2.zetapush.com"><span>Documentation v2</span><i class="fa fa-angle-right"></i></a></li>
    </ul>
    <div>
      <div class="contact-us">
        <a href="https://spectrum.chat/zetapush" target="_blank">Contact us</a>
      </div>
      <div class="github">
        <a href="https://github.com/zetapush" target="_blank">
          <span>Join us on</span><i class="fa fa-github-alt" title="Github"></i></a>
      </div>
      <div class="search">
        <input id="search-input" placeholder="Search for products">
        <div class="search-results">
          <div id="search-hits"></div>
        </div>
      </div>
      <div class="logo">
        <a href="https://zetapush.com"><span class="icon"></span></a>
      </div>
    </div>
  </nav>
</header>
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_deployment">Deployment</a>
<ul class="sectlevel2">
<li><a href="#_what_is_deployment">What is deployment ?</a></li>
<li><a href="#_requirements">Requirements</a></li>
<li><a href="#_how_to_deploy_your_application">How to deploy your application ?</a></li>
<li><a href="#_how_to_deploy_only_the_em_worker_em">How to deploy only the <em>worker</em> ?</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_deployment"><a class="anchor" href="#_deployment"></a>Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once you have develop your application and test it, you may want to deploy it.</p>
</div>
<div class="sect2">
<h3 id="_what_is_deployment"><a class="anchor" href="#_what_is_deployment"></a>What is deployment ?</h3>
<div class="paragraph">
<p>When you <em>deploy</em> your application on the ZetaPush cloud,
actually your application is split in two parts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The worker that contains your <em>custom cloud services</em></p>
</li>
<li>
<p>The static files for the front end</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_worker"><a class="anchor" href="#_worker"></a>Worker</h4>
<div class="paragraph">
<p>When you deploy the worker (<em>custom cloud services</em>) of your application, we take care of the hosting of your code.
In addition we manage the redundancy, the load-balancing,
the high availability and the automatic scability of your <em>custom cloud services</em>.</p>
</div>
<div class="paragraph">
<p>A worker may also provide HTTP endpoints in addition to bidirectionnal connection provided as-is by ZetaPush.
If so, once published on the ZetaPush cloud, the HTTP url is displayed in your terminal.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>URLs to access your worker in HTTP(s) are also available in the <a href="https://console-celtia.zetapush.com" target="_blank" rel="noopener">ZetaPush web console</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_front_end"><a class="anchor" href="#_front_end"></a>Front end</h4>
<div class="paragraph">
<p>For the front end part, the ZetaPush cloud hosts your application.
ZetaPush also manages redundancy of the static files in order to ensure
the high availability of you front end application.</p>
</div>
<div class="paragraph">
<p>The URL to access to your application is displayed in your terminal.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>URLs to access your front end are also available in the <a href="https://console-celtia.zetapush.com" target="_blank" rel="noopener">ZetaPush web console</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_requirements"><a class="anchor" href="#_requirements"></a>Requirements</h3>
<div class="paragraph">
<p>To execute or deploy your application you need to use the <em>Command Line Interface (CLI)</em>.</p>
</div>
<div class="paragraph">
<p>You can check if you already installed the CLI with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ zeta --version</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the CLI returns a result as <code>0.32.0</code>, the CLI is installed.</p>
</div>
<div class="paragraph">
<p>Otherwise, you can install it with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm install -g @zetapush/cli</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_deploy_your_application"><a class="anchor" href="#_how_to_deploy_your_application"></a>How to deploy your application ?</h3>
<div class="paragraph">
<p>The deployment is very easy, to do this you only need to launch this command in your application directory:</p>
</div>
<div class="listingblock">
<div class="title">Deploy the application</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm run deploy</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Npm script alias</div>
<div class="paragraph">
<p><code>npm run deploy</code> is a script alias defined in the <code>package.json</code> file.
The command that is executed under the hood is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ zeta push</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The command will read the <code>.zetarc</code> file. If there is no <em>appName</em>, <em>developerLogin</em> and <em>developerPassword</em> properties or if the ZetaPush account is not validated, you will not be able to push your application.</p>
</div>
<div class="paragraph">
<p>When you deploy your application (Front + Worker), the CLI displays the URLs to use it.
Run the command and you should see something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">&gt; zeta push

[INFO] Using application defined in configuration: v79ivn00l  ‌
[INFO] Bundle your application components  ‌
[INFO] ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇ Upload code                                       <i class="conum" data-value="1"></i><b>(1)</b>
[INFO] ▇▇▇▇▇▇▇▇▇▇░░░░░░░░░░ Prepare environment
[INFO] ░░░░░░░░░░░░░░░░░░░░ Publish web application
[INFO] ░░░░░░░░░░░░░░░░░░░░ Preparing custom cloud services for deployment
[INFO] ░░░░░░░░░░░░░░░░░░░░ Publish custom cloud service on worker instance</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <em>CLI</em> displays progress bars to indicate all deployment tasks and
which tasks are currently being executed</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once the deployment has succeeded, you should see the URLs where your worker and
front are available:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">&gt; zeta push

[INFO] Using application defined in configuration: v79ivn00l  ‌
[INFO] Bundle your application components  ‌
[INFO] ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇ Upload code
[INFO] ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇ Prepare environment
[INFO] ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇ Publish web application
[INFO] ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇ Preparing custom cloud services for deployment
[INFO] ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇ Publish custom cloud service on worker instance
[INFO] Web application front is available at http://front-v79ivn00l.celtia.zetapush.app:80/  ‌      <i class="conum" data-value="1"></i><b>(1)</b>
[INFO] Worker application queue_0 is available at http://queuea0-v79ivn00l.test.zetapush.app  ‌     <i class="conum" data-value="2"></i><b>(2)</b>
[INFO] Worker applications works only if you listen process.env.HTTP_PORT  ‌</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The URL for your front available on the Internet</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The URL for the HTTP endpoint of your worker (if you have one)</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can click (<span class="keyseq"><kbd>Ctrl</kbd>+<kbd>click</kbd></span>) in the terminal on the front URL (or open a web browser
and enter the front URL).
You can see that your application is deployed.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Redeploy</div>
<div class="paragraph">
<p>Obviously, you can publish your application again anytime you want to update it.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Shared <em>built-in cloud services</em></div>
<div class="paragraph">
<p>You can notice that the data that was stored when you were running your application
locally is also available once the application is deployed.</p>
</div>
<div class="paragraph">
<p>This is normal because this is the same application.
So the application uses the same <em>built-in cloud services</em>.</p>
</div>
<div class="paragraph">
<p>If you want to separate data between your local development and the deployed application,
you need to define several <a href="../../reference.html#manage_environments">environments</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Partial deployment</div>
<div class="paragraph">
<p>It is possible to <a href="../../reference.html#partial_deployment">deploy only one part of your application</a> (only the front or only the worker).</p>
</div>
<div class="paragraph">
<p>This can be useful for example when there is a bug that is fixed by exclusively patching the front part.
So you just want to deploy your front but not deploy the same worker code again (and vice versa).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">How to have initialization code</div>
<div class="paragraph">
<p>A <em>custom cloud service</em> may have initialization code to configure and prepare your application.</p>
</div>
<div class="paragraph">
<p>As said before, once published in the ZetaPush cloud, ZetaPush handles scalability and
high availability. So several worker instances will run in the same time and ZetaPush will
load-balance traffic between worker instances. In order to ensure that <strong>only one worker</strong> executes
some initialization code, ZetaPush provides <a href="../../reference.html#onapplicationbootstrap"><code>onApplicationBootstrap</code> special method</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Snapshot and rollback</div>
<div class="paragraph">
<p>In future version, every deployment will trigger a <a href="../../reference.html#snapshots">snapshot</a> to store
the whole application state and data. The aim is to provide you a tool to
quickly restore the previous version.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_deploy_only_the_em_worker_em"><a class="anchor" href="#_how_to_deploy_only_the_em_worker_em"></a>How to deploy only the <em>worker</em> ?</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <em>Worker</em> is the back end of your application. Generally you put your business logic inside it.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you want to deploy your worker only on the ZetaPush platform, you can launch:</p>
</div>
<div class="listingblock">
<div class="title">Deploy the worker</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ npm run deploy -- --worker</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>npm run deploy</code> is a script alias defined in the <code>package.json</code> file.
The command that is executed under the hood is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="console">$ zeta push --worker</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In this case you only deploy your back end code, so no URL will be returned.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-11-20 17:20:23 UTC
</div>
</div>
</body>
</html>