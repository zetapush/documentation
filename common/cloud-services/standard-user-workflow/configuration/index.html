<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>Properties of "application.json" file</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../../..//javascripts/menu.js"></script>
<script type="text/javascript" src="../../../..//javascripts/sidebar.js"></script>
<script type="text/javascript" src="../../../..//javascripts/steps.js"></script>
<script type="text/javascript" src="../../../..//javascripts/sourcecode/source-utils.js"></script>
<script type="text/javascript" src="../../../..//javascripts/sourcecode/highlight-lines.js"></script>
<script type="text/javascript" src="../../../..//javascripts/sourcecode/collapse-lines.js"></script>
<script type="text/javascript" src="../../../..//javascripts/tabcontainer.js"></script>
<script type="text/javascript" src="//unpkg.com/clipboard@2.0.0/dist/clipboard.min.js"></script>
<script type="text/javascript" src="../../../..//javascripts/clipboard.js"></script>
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.js"></script>
<script type="text/javascript" src="../../../..//javascripts/search.js"></script>
<!-- <link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.2/united/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css"
  /> -->
<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,800" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="../../../..//styles/zetapush-styles.css" />
<link rel="stylesheet" type="text/css" href="../../../..//styles/custom-styles.css" />
<link rel="stylesheet" type="text/css" href="../../../..//styles/tabcontainer.css" />
<link rel="stylesheet" type="text/css" href="../../../..//styles/steps.css" />
<link rel="stylesheet" type="text/css" href="../../../..//styles/sourcecode/collapse-lines.css" />
<link rel="stylesheet" type="text/css" href="../../../..//styles/sourcecode/highlight-lines.css" />
<link rel="stylesheet" type="text/css" href="../../../..//styles/clipboard.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.css">
<script type="text/html" id="hit-template">
  <div class="hit">
    <div class="hit-content">
      <div class="context">
        <a href="{{sourceFile.url}}">{{sourceFile.title}}</a>
        {{#parents}}
          <a href="{{url}}">{{title}}</a>
        {{/parents}}
        <a href="{{url}}">{{{_highlightResult.title.value}}}</a>
      </div>
      <pre class="hit-description">{{{_highlightResult.content.value}}}</pre>
    </div>
  </div>
</script>
<header>
  <nav>
    <div class="main-title"><span></span><i class="fa fa-caret-down"></i></div>
    <ul>
      <li><a href="/documentation"><span>ZetaPush documentation</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/quick-start.html"><span>Quick start</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/developer-manual.html"><span>Developer manual</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/how-to.html"><span>How to guides</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/tutorials.html"><span>Tutorials</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/reference.html"><span>Reference</span><i class="fa fa-angle-right"></i></a></li>
    </ul>
    <div>
      <div class="contact-us">
        <a href="https://spectrum.chat/zetapush" target="_blank">Contact us</a>
      </div>
      <div class="github">
        <a href="https://github.com/zetapush" target="_blank">
          <span>Join us on</span><i class="fa fa-github-alt" title="Github"></i></a>
      </div>
      <div class="search">
        <input id="search-input" placeholder="Search for products">
        <div class="search-results">
            <div id="search-hits"></div>
        </div>
      </div>
      <div class="logo">
        <a href="https://zetapush.com"><span class="icon"></span></a>
      </div>
    </div>
  </nav>
</header>
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_properties_of_application_json_file">Properties of "application.json" file</a></li>
<li><a href="#_change_the_email_delivery_method_via_application_json_file">Change the email delivery method via "application.json" file</a></li>
<li><a href="#_configuration_as_code">Configuration as code</a>
<ul class="sectlevel2">
<li><a href="#_account_configuration">Account configuration</a></li>
<li><a href="#_email_configuration">Email configuration</a></li>
<li><a href="#_redirection_configuration">Redirection configuration</a></li>
<li><a href="#_token_configuration">Token configuration</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The <strong>Standard User Workflow</strong> can be easily configured : By the properties (<code>application.json</code> file) or by the configuration as code. With the properties you can change some basic behaviors and with the configuration as code you can configure the entire behavior of the cloud service.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_properties_of_application_json_file"><a class="anchor" href="#_properties_of_application_json_file"></a>Properties of "application.json" file</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can see below the basic version of the <code>application.json</code> file with some explanations :</p>
</div>
<div class="listingblock">
<div class="title">application.json</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td>
  <td class="code"><pre>{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">email</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">from</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">celtia@zetapush.com</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="1"></i><b>(1)</b>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">registration</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">confirmation</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">base-url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:2999</span><span class="delimiter">&quot;</span></span>, <i class="conum" data-value="2"></i><b>(2)</b>
      <span class="key"><span class="delimiter">&quot;</span><span class="content">email</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">subject</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Please confirm your account registration</span><span class="delimiter">&quot;</span></span>
      },
      <span class="key"><span class="delimiter">&quot;</span><span class="content">success-url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:3000#login</span><span class="delimiter">&quot;</span></span>, <i class="conum" data-value="3"></i><b>(3)</b>
      <span class="key"><span class="delimiter">&quot;</span><span class="content">failure-url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:3000#confirmation-failed</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="4"></i><b>(4)</b>
    }
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">mailjet</span><span class="delimiter">&quot;</span></span>: { <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">apikey-public</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">apikey-private</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
  }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We configure the email sender</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>the <code>base-url</code> property is necessary to run the application in local. This property will soon be optional.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Link of your application where the user will be redirected when he confirms his account.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Link of your application where the user will be redirected when the confirmation failed.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Your Mailjet properties.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_change_the_email_delivery_method_via_application_json_file"><a class="anchor" href="#_change_the_email_delivery_method_via_application_json_file"></a>Change the email delivery method via "application.json" file</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can change the method to send the confirmation email by changing the properties in the <code>application.json</code> file.
By default, the Standard User Workflow uses a Mailjet implementation. You can use a <em>SMTP</em> configuration using this properties :</p>
</div>
<div class="listingblock">
<div class="title">application.json</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td>
  <td class="code"><pre>{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">smtp</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">host</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my-smtp-host</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">port</span><span class="delimiter">&quot;</span></span>: <span class="integer">465</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my-smtp-username</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my-smtp-password</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">ssl</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">starttls</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>
  }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>port</em>, <em>ssl</em> and <em>starttls</em> properties are optional (By default the port number 465 is used and the <em>ssl</em> and <em>starttls</em> are activated). The port is also deducted from the <em>ssl</em> and <em>starttls</em> properties.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>ssl</em> <strong>and</strong> <em>starttls</em> activated</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">port 465</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">only <em>startls</em> activated</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">port 587</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Neither <em>ssl</em> nor <em>starttls</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">25</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You can also write many configurations in your <code>application.json</code> file and enable one of them :</p>
</div>
<div class="listingblock">
<div class="title">application.json</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
  <td class="code"><pre>{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">mailjet</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">enable</span><span class="delimiter">&quot;</span></span>: <span class="value">false</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">apikey-public</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my-public-api-key</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">apikey-private</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my-private-api-key</span><span class="delimiter">&quot;</span></span>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">smtp</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">host</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my-smtp-host</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">port</span><span class="delimiter">&quot;</span></span>: <span class="integer">465</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my-smtp-username</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my-smtp-password</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">ssl</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">starttls</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>
  }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, two configuration are written but only the SMTP configuration will be used.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_as_code"><a class="anchor" href="#_configuration_as_code"></a>Configuration as code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default configuration as code of the <strong>Standard User Workflow</strong> is the following :</p>
</div>
<div class="listingblock">
<div class="title">Configuration as code - Standard User Workflow</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre></td>
  <td class="code"><pre><span class="comment">// The root configurer</span>
let userManagementConfigurer = <span class="keyword">new</span> StandardUserWorkflowConfigurerImpl(properties, zetapushContext);

userManagementConfigurer
  <span class="comment">// Configuration of the registration</span>
  .registration()
    .account()
      <span class="comment">// By default the account is stored with the ZetaPush procedure</span>
      .storage(LegacyAdapterUserRepository)
      .uuid()
        .generator(TimestampBasedUuidGenerator)
        .and()
      <span class="comment">// By default, the account need validation</span>
      .initialStatus()
        .value(StandardAccountStatus.WaitingConfirmation)
        .and()
      .and()
    <span class="comment">// We configure how to confirm the account</span>
    .confirmation()
      .token()
        .storage(GdaTokenRepository)
        .generator(Base36RandomTokenGenerator)
        .validity(DEFAULT_CONFIRMATION_TOKEN_VALIDITY)
        .and()
      .url(DEFAULT_CONFIRMATION_URL)
      <span class="comment">// How to send the confirmation email</span>
      .email()
        .mailjet()
          .enable(DEFAULT_MAILJET_ENABLE(properties))
          .url(DEFAULT_MAILJET_URL(properties))
          .apiKeyPublic(DEFAULT_MAILJET_API_KEY_PUBLIC(properties))
          .apiKeyPrivate(DEFAULT_MAILJET_API_KEY_PRIVATE(properties))
          .and()
        .smtp()
          .enable(DEFAULT_SMTP_ENABLE(properties))
          .host(DEFAULT_SMTP_HOST(properties))
          .port(DEFAULT_SMTP_PORT(properties))
          .username(DEFAULT_SMTP_USERNAME(properties))
          .password(DEFAULT_SMTP_PASSWORD(properties))
          .ssl(DEFAULT_SMTP_SSL(properties))
          .starttls(DEFAULT_SMTP_STARTTLS(properties))
          .and()
        .from(DEFAULT_CONFIRMATION_SENDER(properties))
        .subject(DEFAULT_CONFIRMATION_SUBJECT(properties))
        .htmlTemplate()
          .template(DEFAULT_CONFIRMATION_HTML_TEMPLATE)
            .and()
        .textTemplate()
          .template(DEFAULT_CONFIRMATION_TEXT_TEMPLATE)
          .and()
        .and()
      <span class="comment">// Redirection when the user confirms his account</span>
      .redirection()
        .successUrl(DEFAULT_CONFIRMATION_SUCCESS_REDIRECTION(properties, zetapushContext))
        .failureUrl(DEFAULT_CONFIRMATION_FAILURE_REDIRECTION(properties, zetapushContext));</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_account_configuration"><a class="anchor" href="#_account_configuration"></a>Account configuration</h3>
<div class="sect3">
<h4 id="_change_initial_status"><a class="anchor" href="#_change_initial_status"></a>Change initial status</h4>

</div>
</div>
<div class="sect2">
<h3 id="_email_configuration"><a class="anchor" href="#_email_configuration"></a>Email configuration</h3>
<div class="sect3">
<h4 id="_change_from_field"><a class="anchor" href="#_change_from_field"></a>Change from field</h4>

</div>
<div class="sect3">
<h4 id="_change_subject_field"><a class="anchor" href="#_change_subject_field"></a>Change subject field</h4>

</div>
<div class="sect3">
<h4 id="_change_used_sender_method"><a class="anchor" href="#_change_used_sender_method"></a>Change used sender method</h4>

</div>
<div class="sect3">
<h4 id="_change_smtp_configuration"><a class="anchor" href="#_change_smtp_configuration"></a>Change SMTP configuration</h4>

</div>
<div class="sect3">
<h4 id="_change_mailjet_configuration"><a class="anchor" href="#_change_mailjet_configuration"></a>Change Mailjet configuration</h4>

</div>
<div class="sect3">
<h4 id="_change_template"><a class="anchor" href="#_change_template"></a>Change template</h4>

</div>
</div>
<div class="sect2">
<h3 id="_redirection_configuration"><a class="anchor" href="#_redirection_configuration"></a>Redirection configuration</h3>
<div class="sect3">
<h4 id="_change_redirection_url"><a class="anchor" href="#_change_redirection_url"></a>Change redirection URL</h4>

</div>
</div>
<div class="sect2">
<h3 id="_token_configuration"><a class="anchor" href="#_token_configuration"></a>Token configuration</h3>
<div class="sect3">
<h4 id="_change_token_validity"><a class="anchor" href="#_change_token_validity"></a>Change token validity</h4>

</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-09-25 10:45:36 CEST
</div>
</div>
</body>
</html>