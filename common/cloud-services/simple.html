<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>Simple</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../..//javascripts/menu.js"></script>
<script type="text/javascript" src="../..//javascripts/sidebar.js"></script>
<script type="text/javascript" src="../..//javascripts/steps.js"></script>
<script type="text/javascript" src="../..//javascripts/sourcecode/source-utils.js"></script>
<script type="text/javascript" src="../..//javascripts/sourcecode/highlight-lines.js"></script>
<script type="text/javascript" src="../..//javascripts/sourcecode/collapse-lines.js"></script>
<script type="text/javascript" src="../..//javascripts/tabcontainer.js"></script>
<script type="text/javascript" src="//unpkg.com/clipboard@2.0.0/dist/clipboard.min.js"></script>
<script type="text/javascript" src="../..//javascripts/clipboard.js"></script>
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.js"></script>
<script type="text/javascript" src="../..//javascripts/search.js"></script>
<!-- <link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.2/united/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css"
  /> -->
<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,800" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="../..//styles/zetapush-styles.css" />
<link rel="stylesheet" type="text/css" href="../..//styles/custom-styles.css" />
<link rel="stylesheet" type="text/css" href="../..//styles/tabcontainer.css" />
<link rel="stylesheet" type="text/css" href="../..//styles/steps.css" />
<link rel="stylesheet" type="text/css" href="../..//styles/sourcecode/collapse-lines.css" />
<link rel="stylesheet" type="text/css" href="../..//styles/sourcecode/highlight-lines.css" />
<link rel="stylesheet" type="text/css" href="../..//styles/clipboard.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.css">
<script type="text/html" id="hit-template">
  <div class="hit">
    <div class="hit-content">
      <div class="context">
        <a href="{{sourceFile.url}}">{{sourceFile.title}}</a>
        {{#parents}}
          <a href="{{url}}">{{title}}</a>
        {{/parents}}
        <a href="{{url}}">{{{_highlightResult.title.value}}}</a>
      </div>
      <pre class="hit-description">{{{_highlightResult.content.value}}}</pre>
    </div>
  </div>
</script>
<header>
  <nav>
    <div class="main-title"><span></span><i class="fa fa-caret-down"></i></div>
    <ul>
      <li><a href="/documentation"><span>ZetaPush documentation</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/quick-start.html"><span>Quick start</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/developer-manual.html"><span>Developer manual</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/how-to.html"><span>How to guides</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/tutorials.html"><span>Tutorials</span><i class="fa fa-angle-right"></i></a></li>
      <li><a href="/documentation/reference.html"><span>Reference</span><i class="fa fa-angle-right"></i></a></li>
    </ul>
    <div>
      <div class="contact-us">
        <a href="https://spectrum.chat/zetapush" target="_blank">Contact us</a>
      </div>
      <div class="github">
        <a href="https://github.com/zetapush" target="_blank">
          <span>Join us on</span><i class="fa fa-github-alt" title="Github"></i></a>
      </div>
      <div class="search">
        <input id="search-input" placeholder="Search for products">
        <div class="search-results">
            <div id="search-hits"></div>
        </div>
      </div>
      <div class="logo">
        <a href="https://zetapush.com"><span class="icon"></span></a>
      </div>
    </div>
  </nav>
</header>
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_simple">Simple</a>
<ul class="sectlevel2">
<li><a href="#_createuser">createUser</a></li>
<li><a href="#_credentials">credentials</a></li>
<li><a href="#_updatekey">updateKey</a></li>
<li><a href="#_updateuser">updateUser</a></li>
<li><a href="#_deleteuser">deleteUser</a></li>
<li><a href="#_checkuser">checkUser</a></li>
<li><a href="#_requestreset">requestReset</a></li>
<li><a href="#_changepassword">changePassword</a></li>
<li><a href="#_checkpassword">checkPassword</a></li>
<li><a href="#_how_to_use_it">How to use it ?</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_simple"><a class="anchor" href="#_simple"></a>Simple</h2>
<div class="sectionbody">
<div class="paragraph">
<p>End-user API for the simple local authentication</p>
</div>
<div class="paragraph">
<p>These API verbs allow end-users to manage their account(s).</p>
</div>
<div class="sect2">
<h3 id="_createuser"><a class="anchor" href="#_createuser"></a>createUser</h3>
<div class="paragraph">
<p>Creates a new account in this 'simple' authentication realm.
Returns a map of account fields, including a field named &lt;i&gt;zetapushKey&lt;/i&gt; containing the global user key of the user (value of the &lt;b&gt;__userKey&lt;/b&gt; pseudo-constant when this new account will be used)</p>
</div>
<div class="listingblock">
<div class="title">createUser(parameters: <a href="../../common/cloud-services-types/basic-authenticated-user.html">BasicAuthenticatedUser</a>): Promise&lt;<a href="../../common/cloud-services-types/map&.html#8592;string">-object&gt;.adoc#,Map&lt;String,Object</a>&gt;&gt;</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>const response = await this.simple.createUser(parameters);</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_credentials"><a class="anchor" href="#_credentials"></a>credentials</h3>
<div class="paragraph">
<p>Returns the list of account credentials in this service for the asking user.
Might return an empty list.</p>
</div>
<div class="listingblock">
<div class="title">credentials(parameters: <a href="../../common/cloud-services-types/impersonated-traceable-request.html">ImpersonatedTraceableRequest</a>): Promise&lt;<a href="../../common/cloud-services-types/all-credentials.html">AllCredentials</a>&gt;</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>const response = await this.simple.credentials(parameters);</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_updatekey"><a class="anchor" href="#_updatekey"></a>updateKey</h3>
<div class="paragraph">
<p>Updates an existing account primary key (login, NOT &lt;b&gt;__userKey&lt;/b&gt;) in this 'simple' authentication realm.
The updated account MUST belong to the user making the call.
The configured login field MUST be given, as a user (identified by his zetapush userKey) might possess several accounts.
Returns a map of account fields</p>
</div>
<div class="listingblock">
<div class="title">updateKey(parameters: <a href="../../common/cloud-services-types/user-loginchange.html">UserLoginchange</a>): Promise&lt;<a href="../../common/cloud-services-types/map&.html#8592;string">-object&gt;.adoc#,Map&lt;String,Object</a>&gt;&gt;</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>const response = await this.simple.updateKey(parameters);</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_updateuser"><a class="anchor" href="#_updateuser"></a>updateUser</h3>
<div class="paragraph">
<p>Updates an existing account in this 'simple' authentication realm.
The updated account MUST belong to the user making the call.
The configured login field MUST be given, as a user (identified by his zetapush userKey) might possess several accounts.
Returns a map of account fields</p>
</div>
<div class="listingblock">
<div class="title">updateUser(parameters: <a href="../../common/cloud-services-types/basic-authenticated-user.html">BasicAuthenticatedUser</a>): Promise&lt;<a href="../../common/cloud-services-types/map&.html#8592;string">-object&gt;.adoc#,Map&lt;String,Object</a>&gt;&gt;</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>const response = await this.simple.updateUser(parameters);</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deleteuser"><a class="anchor" href="#_deleteuser"></a>deleteUser</h3>
<div class="paragraph">
<p>Deletes an existing account in this 'simple' authentication realm.</p>
</div>
<div class="listingblock">
<div class="title">deleteUser(parameters: <a href="../../common/cloud-services-types/existence-check.html">ExistenceCheck</a>): Promise&lt;<a href="../../common/cloud-services-types/existence-check.html">ExistenceCheck</a>&gt;</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>const response = await this.simple.deleteUser(parameters);</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_checkuser"><a class="anchor" href="#_checkuser"></a>checkUser</h3>
<div class="paragraph">
<p>Checks whether the given account already exists in this 'simple' authentication realm.
This verb returns all the information about the user, including non public fields.</p>
</div>
<div class="listingblock">
<div class="title">checkUser(parameters: <a href="../../common/cloud-services-types/existence-check.html">ExistenceCheck</a>): Promise&lt;<a href="../../common/cloud-services-types/map&.html#8592;string">-object&gt;.adoc#,Map&lt;String,Object</a>&gt;&gt;</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>const response = await this.simple.checkUser(parameters);</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_requestreset"><a class="anchor" href="#_requestreset"></a>requestReset</h3>
<div class="paragraph">
<p>Requests a password reset for the given unique account key.
The account key must exist and must be given, as it cannot obviously be deduced from the currently logged in user.
The returned token needs to be sent to the intended recipient only. The typical use case is to define a macro that requests a reset, generates a email template and emails the user. The macro can then be safely called by a weakly authenticated user.
Requesting a reset does not invalidate the password.
Requesting a reset again invalidates previous reset requests (only the last token is usable)</p>
</div>
<div class="listingblock">
<div class="title">requestReset(parameters: <a href="../../common/cloud-services-types/reset-request.html">ResetRequest</a>): Promise&lt;<a href="../../common/cloud-services-types/reset-info.html">ResetInfo</a>&gt;</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>const response = await this.simple.requestReset(parameters);</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_changepassword"><a class="anchor" href="#_changepassword"></a>changePassword</h3>
<div class="paragraph">
<p>Changes a user password for this authentication realm.
The user can be either explicit, implicit (one of the current user&#8217;s accounts) or deduced from the token.
You should provide at least one of 'key' and 'token'. If you do not, the server will try and find any key for the current user.
The change is effective immediately. However, already logged in users might stay connected.
The password and token fields are always null in the output.</p>
</div>
<div class="listingblock">
<div class="title">changePassword(parameters: <a href="../../common/cloud-services-types/change-password-request.html">ChangePasswordRequest</a>): Promise&lt;<a href="../../common/cloud-services-types/change-password-request.html">ChangePasswordRequest</a>&gt;</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>const response = await this.simple.changePassword(parameters);</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_checkpassword"><a class="anchor" href="#_checkpassword"></a>checkPassword</h3>
<div class="listingblock">
<div class="title">checkPassword(parameters: <a href="../../common/cloud-services-types/check-password-request.html">CheckPasswordRequest</a>): Promise&lt;<a href="../../common/cloud-services-types/check-password-result.html">CheckPasswordResult</a>&gt;</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>const response = await this.simple.checkPassword(parameters);</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_use_it"><a class="anchor" href="#_how_to_use_it"></a>How to use it ?</h3>
<div class="listingblock">
<div class="title">worker/index.ts</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="typescript"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td>
  <td class="code"><pre>import { Injectable, Simple, BasicAuthenticatedUser } from '@zetapush/platform'; <i class="conum" data-value="1"></i><b>(1)</b>

@Injectable()
export default class Api {
  constructor(
    private simple: Simple <i class="conum" data-value="2"></i><b>(2)</b>
  ) {}
  async doStuff(parameters: BasicAuthenticatedUser) {
    const response = await this.simple.createUser(parameters); <i class="conum" data-value="3"></i><b>(3)</b>
    return response;
  }
}</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Import <code>Simple</code> from platform</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Declare injected service</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Call injected service</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-09-26 15:58:41 CEST
</div>
</div>
</body>
</html>