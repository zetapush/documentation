:relative-path: ./
include::{docdir}/variables.adoc[]

:appName: hello-world

////

Objectifs : apprendre à utiliser ZetaPush, comprendre les concepts et gagner du temps sur mon dev

== Requirements

X si déjà installé, on peut passer la section

=== System requirements

X installation

=== Using CLI

X ok

== ZetaPush concepts

Objectif : faire comprendre et utiliser les concepts fondamentaux de ZetaPush

X compte
  X expliquer qu'on doit avoir un compte
  X expliquer comment obtenir un compte (formulaire de demande)
  X expliquer que dans le futur, on pourra créer un compte soi-même
X organisation
X application
X env (futur)

== Develop your front with ZetaPush

Objectif : dire que ZetaPush fourni des services prêts à l'usage qui pourront à l'avenir être consommé directement.

X liste des services dispos
X requirements

X enlever la partie consommer un custom cloud service

== Develop your business logic

Objectif : accompagner le développeur à comprendre comment écrire son code métier rapidement et l'utiliser depuis son front

X définition
X coder un cloud service simple
  X define a custom cloud service
    X note pour dire qu'on peut créer plusieurs cloud services dans le même worker (+ namespace)
  X expose a custom cloud service
    X note pour dire qu'on peut exposer plusieurs cloud services
  X use your custom cloud service in your front
    X note pour dire qu'on peut faire autre chose que du web ?
  X run a custom cloud service
    X note pour lancer que le cloud service
  X compose cloud services
    X dependency injection
      X note pour aller voir plus en profondeur dans le fonctionnement de l'injection de dépendance
    X use built-in cloud service
      -> note pour voir comment configurer les cloud services
    X use another custom cloud service
      X note pour dire qu'on peut créer un module réutilisable
      X note pour distinguer qu'on peut avoir des clouds services privés et d'autres exposés

- develop fast
  X hot reload
    X montrer comment gagner du temps
    X note pour autres fichiers (fichiers de conf dans futur)
  X auto-completion
  - logs
    -> montrer comment logguer pour gagner du temps d'analyse
  X debug
    X montrer comment débugger rapidement du code
  X testing
    X montrer comment les tests peuvent faire gagner du temps

== Deploy/publish your application

Objectif : montrer comment déployer une application complète (front + worker)

indiquer qu'on peut redéployer à n'importe quel moment

.How to have initialization code
[NOTE]
====
A _custom cloud service_ may have initialization code to configure and prepare your application.

As said before, once published in the ZetaPush cloud, ZetaPush handles scalability and
high availability. So several worker instances will run in the same time and ZetaPush will
load-balance traffic between worker instances. In order to ensure only one ...
====


-> retirer parties avec déploiement partiel et mettre des liens à la place

== User management in your application

Objectif : montrer comment rapidement obtenir une gestion des utilisateurs pour se concentrer sur le code utile

- import user-management module
- configure for your needs
  -> note pour configuration avancée
  -> note pour adaptation (utiliser implementations custom)
- write your front to consume it
- test it locally
- test it remotely

== Store data in your application

Objectif : montrer comment rapidement stocker, lister, rechercher des données pour se concentrer sur le code utile

futur

== Secure your application

Objectif : montrer comment rapidement isoler, bloquer et filtrer l'accès à des fonctions/données

futur

////

= Developer manual

== Requirements

[NOTE]
====
If you already prepared your environment, you can skip this section.
====

=== System requirements

include::{docdir}/common/prerequisites/prerequisites.adoc[leveloffset=+1]

=== Using CLI

include::{docdir}/common/manual-initialization/use-manual-application.adoc[leveloffset=+2]

== ZetaPush concepts


In order to be able to use ZetaPush, you need a *ZetaPush account*. Your account is used when
you develop to run your project locally or to deploy it on ZetaPush cloud.

The code you produce is bound to an *application*.

An account belongs to an *organization*. An organization is useful to work in team.
You can have several applications for your organization.
You can manage access rights on applications according to members of your team.

As usual in development, you may need to run your application in different contexts (dev, continuous integration, 
prod...).
Each application may have several *environments*.
You can also manage access rights on environments according to members of your team.

[TIP]
====
Learn how to <<reference.adoc#add_application, add an application to your organization>>.

Learn how to <<reference.adoc#add_environment, add an environment to your application>>.

Learn how to <<reference.adoc#access_control_per_application, control access for an application>>.

Learn how to <<reference.adoc#access_control_per_environment, control access for a particular environment>>.
====

[IMPORTANT]
====
For now, environments are not fully supported but this feature will be available soon.
====


=== Create your account

Currently, the only way to get a ZetaPush account is by contacting us. The aim is to understand your needs
and to advise you even if you just want to test it:

* link:https://www.zetapush.com/sign-up-for-a-free-trial/[Signup for a free trial]
* link:https://www.zetapush.com/contact/[Contact us for more suitable account]

Your account will be created soon after the first contact and an application that fits your
needs will be available. Then you are ready to start working with ZetaPush.

[NOTE]
====
Soon we will open access to everyone for free trial. Account creation will be available through
our CLI tool, from the main site and the web console.
====


////
When you use ZetaPush the first time, you need to create an account. Once your account is ready, you
can already start to work. You work is associated with an application.

Here we explain how to create both an account and an application quickly.

==== Using ZetaPush main site

[TODO]
====
This section will describe how to register your account through main site (mainly using screenshots).

You can make a PR if you want to contribute: https://github.com/zetapush/documentation/issues/47
====

==== Using ZetaPush web Console


[TODO]
====
This section will describe how to register your account through web console (mainly using screenshots).

You can make a PR if you want to contribute: https://github.com/zetapush/documentation/issues/49
====

==== Using your terminal

To create an account and an application, you can use the _CLI_ we provide.
This tool will detect that you are using a new account and will automatically create a new application.

include::{docdir}/common/diagrams/workflow-init-without-account.adoc[leveloffset=+3]

=== Add a new application to your account

==== Using ZetaPush web Console

[TODO]
====
This section will describe how to add a new application through web console (mainly using screenshots).

You can make a PR if you want to contribute: https://github.com/zetapush/documentation/issues/50
====


==== Using your terminal

To add an application to your account, you can also use the _CLI_.
This time you provide your credentials so it will use your account but as you are creating a new
application from the _CLI_, this application will be registered on ZetaPush.

include::{docdir}/common/diagrams/workflow-init-with-account-without-app.adoc[leveloffset=+3]


=== Configure your project to use an existing application

==== Using your terminal

When you work in team, you may want to share an application. The _CLI_ also
provides a parameter to specify the application to reuse. By providing both
credentials and application name, it will just reuse existing application.

include::{docdir}/common/diagrams/workflow-init-with-account-and-app.adoc[leveloffset=+3]

==== Configure your project manually

If you don't want to use the _CLI_, you can also start your project manually by creating some files.

include::{docdir}/common/manual-initialization/introduction.adoc[leveloffset=+3]

include::{docdir}/common/manual-initialization/details-package-json.adoc[leveloffset=+3]

[NOTE]
====
Once your package.json is ready, install the dependencies by running:

[source, console]
----
$ npm install
----
====

include::{docdir}/common/manual-initialization/details-zetarc.adoc[leveloffset=+3]
include::{docdir}/common/manual-initialization/details-front.adoc[leveloffset=+3]
include::{docdir}/common/manual-initialization/details-worker.adoc[leveloffset=+3]


////



== Develop your front with ZetaPush

You may want to quickly provide a web application by just focusing on the visible part and the user experience
instead of wasting time on technical concerns.

ZetaPush provides built-in _cloud services_ to increase your productivity:

include::{docdir}/common/cloud-services/summary.adoc[leveloffset=+3]


ZetaPush cloud services need to be "created" before being able to use them. This way, you
can choose which services are part of your application instead of having them all.

[IMPORTANT]
====
Currently, using a front to interact with ZetaPush cloud services directly is not really possible due to
this "creation" phase. For security reasons, service creation and configuration can't be done via
a client. 

When the web console will be fully ready, ZetaPush cloud services "creation" will be
available through the web console.

Hopefully, you can use a worker to declare the use of a ZetaPush cloud service and even configure it. The
"creation" process is automatically handled by the worker.

See the next section to know how to develop _custom cloud services_ and use _ZetaPush cloud services_.
====

////
=== Requirements
include::{docdir}/common/usage-service/requirement-use-service.adoc[leveloffset=+3]


=== Use _cloud services_

==== Use a ZetaPush _cloud service_

Here we show how to create a worker that use the ZetaPush cloud service named `Stack`.


include::{docdir}/common/code/example-use-cloud-service-in-custom.adoc[]

[TIP]
====
`Stack` cloud service "creation" is automatically handled thanks to dependency injection.
ZetaPush detects that you need a ZetaPush service and prepare it.
so you focus your code on the usage of the service
not on its creation, you just ask for it.
====

include::{docdir}/common/code/example-call-stack-cloud-service-from-front.adoc[]


IMPORTANT: When you call a _cloud function_ from the client, the result is always a Promise even if the _custom cloud function_ is synchronous
because everything goes through the network.


==== Use a custom _cloud service_
include::{docdir}/common/usage-service/utilization-service.adoc[leveloffset=+3]


=== Configure/adapt ZetaPush cloud services

[TODO]
====
This section will describe how to configure a ZetaPush cloud service.
The configuration will be possible either through console or through worker.

https://github.com/zetapush/documentation/issues/51
====

=== Run your front locally

[TODO]
====
As described above, currently running only a front is not possible.
You need to have a least worker to create and configure ZetaPush services.

This section will be later described when this feature will be supported.
https://github.com/zetapush/documentation/issues/52
====
////



== Develop your business logic

Even if ZetaPush provides ready to use cloud services, we know that any application needs some
specific behaviors. Instead of limiting your possibilities, we provide a way to help you develop
quickly your own business logic.

=== What is a _custom cloud service_
include::{docdir}/common/custom-cloud-service/presentation-custom-cloud-service.adoc[leveloffset=+2]

=== Develop a _custom cloud services_

==== Define a _custom cloud service_
include::{docdir}/common/custom-cloud-service/create-custom-cloud-service.adoc[leveloffset=+3]

==== Expose a _custom cloud service_
include::{docdir}/common/custom-cloud-service/expose-custom-cloud-service.adoc[leveloffset=+3]

==== Use a _custom cloud service_ in your front
include::{docdir}/common/usage-service/utilization-service.adoc[leveloffset=+3]

==== Run application
include::{docdir}/common/usage-service/run-application.adoc[leveloffset=+3]

==== Compose cloud services

You can compose _cloud services_ either by using _built-in cloud services_ provided by ZetaPush or 
by using another of your _custom cloud services_.

===== Dependency injection
include::{docdir}/common/custom-cloud-service/dependencies-include-services.adoc[leveloffset=+3]

===== Use built-in _cloud service_
include::{docdir}/common/custom-cloud-service/use-cloud-services-in-custom.adoc[leveloffset=+3]

===== Use another _custom cloud service_
include::{docdir}/common/custom-cloud-service/use-custom-cloud-services-in-custom.adoc[leveloffset=+3]

=== Develop fast

==== Hot reload
include::{docdir}/common/development/hot-reload.adoc[leveloffset=+3]

==== Auto-completion
include::{docdir}/common/development/auto-completion.adoc[leveloffset=+3]

==== Log from a _custom cloud service_
include::{docdir}/common/development/logging.adoc[leveloffset=+3]

==== Debug a _custom cloud service_

===== Debug your application with VSCode
include::{docdir}/common/debug/how-to-debug-with-vscode.adoc[leveloffset=+2]

===== Debug your application with IntelliJ based IDE
include::{docdir}/common/debug/how-to-debug-with-webstorm.adoc[leveloffset=+2]

==== Test a _custom cloud service_
include::{docdir}/common/development/testing.adoc[leveloffset=+3]

== Deploy/publish your application

Once you have developed your application and tested it, you may want to deploy it on the ZetaPush cloud.

=== What will be deployed ?

include::{docdir}/common/deploy/what-is-deployment.adoc[leveloffset=+2]

==== Applications and environments

TODO: https://github.com/zetapush/documentation/issues/54


=== Deploy both front and _custom cloud services_ on the ZetaPush Cloud
include::{docdir}/common/deploy/how-to-deploy-app.adoc[leveloffset=+2]

=== Deploy your front on the ZetaPush Cloud
include::{docdir}/common/deploy/how-to-deploy-front.adoc[leveloffset=+2]

=== Deploy your _custom cloud services_ on the ZetaPush Cloud
include::{docdir}/common/deploy/how-to-deploy-worker.adoc[leveloffset=+2]

== User management in your application

== Store data in your application

== Secure your application

////
== Testing

TODO: https://github.com/zetapush/documentation/issues/55

=== Unit testing your front

TODO: https://github.com/zetapush/documentation/issues/56

=== Unit testing your custom cloud services

TODO: https://github.com/zetapush/documentation/issues/57

=== Integration testing your front

TODO: https://github.com/zetapush/documentation/issues/58

=== Integration testing your custom cloud services

TODO: https://github.com/zetapush/documentation/issues/59

=== Functional testing / end-to-end testing

TODO: https://github.com/zetapush/documentation/issues/60

// CONFIGURATION OF CLOUD SERVICES
== Configuration of cloud services

[#configuration-of-standard-user-workflow]
=== Standard User Workflow
include::{docdir}/common/cloud-services/standard-user-workflow/configuration.adoc[leveloffset=+2]

// EXTENSION OF CLOUD SERVICES
== Extension of cloud services

.Run directly from VSCode
[TIP]
====
You can configure VSCode to run your tests. In the main menu, click on menu:Debug[Add Configuration...]:

image::{images-dir}/debug/add-debug-mendu.png[role=center]

Add these lines in the `launch.json` file:

[source, json]
----
    {
      "name": "tests", 
      "type": "node",
      "request": "launch",
      "stopOnEntry": false,
      "sourceMaps": true,
      "runtimeArgs": [
        "-r",
        "ts-node/register"
      ],
      "args": [ 
        "node_modules/jasmine/bin/jasmine.js"
      ],
      "cwd": "${workspaceRoot}",
      "console": "integratedTerminal"
    }
----

Then you can select the `tests' launch configuration and hit kbd:[F5].
====
[#extension-of-standard-user-workflow]
=== Standard User Workflow
include::{docdir}/common/cloud-services/standard-user-workflow/extension.adoc[leveloffset=+2]
////